<!DOCTYPE html>
<!-- saved from url=(0092)https://thepythoncode.com/article/real-time-vehicle-tracking-and-counting-with-yolov8-opencv -->
<html lang="en" style="--dialogAccentColor: #3B93E6; --dialogBackgroundColor: #ffffff; --dialogTextColor: #000000;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="origin-trial" content="A/kargTFyk8MR5ueravczef/wIlTkbVk1qXQesp39nV+xNECPdLBVeYffxrM8TmZT6RArWGQVCJ0LRivD7glcAUAAACQeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZS5jb206NDQzIiwiZmVhdHVyZSI6IkRpc2FibGVUaGlyZFBhcnR5U3RvcmFnZVBhcnRpdGlvbmluZzIiLCJleHBpcnkiOjE3NDIzNDIzOTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="A/kargTFyk8MR5ueravczef/wIlTkbVk1qXQesp39nV+xNECPdLBVeYffxrM8TmZT6RArWGQVCJ0LRivD7glcAUAAACQeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZS5jb206NDQzIiwiZmVhdHVyZSI6IkRpc2FibGVUaGlyZFBhcnR5U3RvcmFnZVBhcnRpdGlvbmluZzIiLCJleHBpcnkiOjE3NDIzNDIzOTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="A/kargTFyk8MR5ueravczef/wIlTkbVk1qXQesp39nV+xNECPdLBVeYffxrM8TmZT6RArWGQVCJ0LRivD7glcAUAAACQeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZS5jb206NDQzIiwiZmVhdHVyZSI6IkRpc2FibGVUaGlyZFBhcnR5U3RvcmFnZVBhcnRpdGlvbmluZzIiLCJleHBpcnkiOjE3NDIzNDIzOTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="A/kargTFyk8MR5ueravczef/wIlTkbVk1qXQesp39nV+xNECPdLBVeYffxrM8TmZT6RArWGQVCJ0LRivD7glcAUAAACQeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZS5jb206NDQzIiwiZmVhdHVyZSI6IkRpc2FibGVUaGlyZFBhcnR5U3RvcmFnZVBhcnRpdGlvbmluZzIiLCJleHBpcnkiOjE3NDIzNDIzOTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/quant.js.download" async="true"></script><script type="text/javascript" async="" charset="utf-8" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/recaptcha__en.js.download" crossorigin="anonymous" integrity="sha384-CUWl3AwpNax4J2/ffIDxMr+sLnEFg8pkj5QqZtMtJZtrL5bS5QTkIoza4qZakWjL"></script><script type="text/javascript" async="" charset="utf-8" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/recaptcha__en.js.download" crossorigin="anonymous" integrity="sha384-CUWl3AwpNax4J2/ffIDxMr+sLnEFg8pkj5QqZtMtJZtrL5bS5QTkIoza4qZakWjL"></script><script type="text/javascript" async="" charset="utf-8" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/recaptcha__en.js.download" crossorigin="anonymous" integrity="sha384-CUWl3AwpNax4J2/ffIDxMr+sLnEFg8pkj5QqZtMtJZtrL5bS5QTkIoza4qZakWjL"></script><script type="text/javascript" async="" charset="utf-8" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/recaptcha__en.js.download" crossorigin="anonymous" integrity="sha384-CUWl3AwpNax4J2/ffIDxMr+sLnEFg8pkj5QqZtMtJZtrL5bS5QTkIoza4qZakWjL"></script><script>var __ezHttpConsent={setByCat:function(src,tagType,attributes,category,force){var setScript=function(){if(force||window.ezTcfConsent[category]){var scriptElement=document.createElement(tagType);scriptElement.src=src;attributes.forEach(function(attr){for(var key in attr){if(attr.hasOwnProperty(key)){scriptElement.setAttribute(key,attr[key]);}}});var firstScript=document.getElementsByTagName(tagType)[0];firstScript.parentNode.insertBefore(scriptElement,firstScript);}};if(force||(window.ezTcfConsent&&window.ezTcfConsent.loaded)){setScript();}else if(typeof getEzConsentData==="function"){getEzConsentData().then(function(ezTcfConsent){if(ezTcfConsent&&ezTcfConsent.loaded){setScript();}else{console.error("cannot get ez consent data");force=true;setScript();}});}else{force=true;setScript();console.error("getEzConsentData is not a function");}},};</script>
<script>var ezTcfConsent=window.ezTcfConsent?window.ezTcfConsent:{loaded:false,store_info:false,develop_and_improve_services:false,measure_ad_performance:false,measure_content_performance:false,select_basic_ads:false,create_ad_profile:false,select_personalized_ads:false,create_content_profile:false,select_personalized_content:false,understand_audiences:false,use_limited_data_to_select_content:false,};function getEzConsentData(){return new Promise(function(resolve){document.addEventListener("ezConsentEvent",function(event){var ezTcfConsent=event.detail.ezTcfConsent;resolve(ezTcfConsent);});});}</script>
<script>function _setEzCookies(ezConsentData){var cookies=[{name:"ezoab_195154",value:"mod134; Path=/; Domain=thepythoncode.com; Expires=Tue, 20 Aug 2024 21:45:39 UTC",tcfCategory:"store_info",isEzoic:"true",},{name:"ezoadgid_195154",value:"-1; Path=/; Domain=thepythoncode.com; Expires=Tue, 20 Aug 2024 20:15:39 UTC",tcfCategory:"understand_audiences",isEzoic:"true",},{name:"ezosuibasgeneris-1",value:"45b4edc3-603b-4577-4e81-9ba982feb706; Path=/; Domain=thepythoncode.com; Expires=Wed, 20 Aug 2025 19:45:39 UTC; Secure; SameSite=None",tcfCategory:"understand_audiences",isEzoic:"true",},{name:"active_template::195154",value:"pub_site.1724183139; Path=/; Domain=thepythoncode.com; Expires=Thu, 22 Aug 2024 19:45:39 UTC",tcfCategory:"store_info",isEzoic:"true",},{name:"ezopvc_195154",value:"1; Path=/; Domain=thepythoncode.com; Expires=Tue, 20 Aug 2024 20:15:39 UTC",tcfCategory:"understand_audiences",isEzoic:"true",}];for(var i=0;i<cookies.length;i++){var cookie=cookies[i];if(ezConsentData&&ezConsentData.loaded&&ezConsentData[cookie.tcfCategory]){document.cookie=cookie.name+"="+cookie.value;}}}
if(window.ezTcfConsent&&window.ezTcfConsent.loaded){_setEzCookies(window.ezTcfConsent);}else if(typeof getEzConsentData==="function"){getEzConsentData().then(function(ezTcfConsent){if(ezTcfConsent&&ezTcfConsent.loaded){_setEzCookies(window.ezTcfConsent);}else{console.error("cannot get ez consent data");_setEzCookies(window.ezTcfConsent);}});}else{console.error("getEzConsentData is not a function");_setEzCookies(window.ezTcfConsent);}</script><script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/gppstub.js.download" async=""></script>
<script data-ezscrex="false" data-cfasync="false" data-pagespeed-no-defer="">var __ez=__ez||{};__ez.stms=Date.now();__ez.evt={};__ez.script={};__ez.ck=__ez.ck||{};__ez.template={};__ez.template.isOrig=false;window.__ezScriptHost="//www.ezojs.com";__ez.queue=function(){var e=0,i=0,t=[],n=!1,o=[],r=[],s=!0,a=function(e,i,n,o,r,s,a){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:window,d=this;this.name=e,this.funcName=i,this.parameters=null===n?null:w(n)?n:[n],this.isBlock=o,this.blockedBy=r,this.deleteWhenComplete=s,this.isError=!1,this.isComplete=!1,this.isInitialized=!1,this.proceedIfError=a,this.fWindow=l,this.isTimeDelay=!1,this.process=function(){u("... func = "+e),d.isInitialized=!0,d.isComplete=!0,u("... func.apply: "+e);var i=d.funcName.split("."),n=null,o=this.fWindow||window;i.length>3||(n=3===i.length?o[i[0]][i[1]][i[2]]:2===i.length?o[i[0]][i[1]]:o[d.funcName]),null!=n&&n.apply(null,this.parameters),!0===d.deleteWhenComplete&&delete t[e],!0===d.isBlock&&(u("----- F'D: "+d.name),m())}},l=function(e,i,t,n,o,r,s){var a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:window,l=this;this.name=e,this.path=i,this.async=o,this.defer=r,this.isBlock=t,this.blockedBy=n,this.isInitialized=!1,this.isError=!1,this.isComplete=!1,this.proceedIfError=s,this.fWindow=a,this.isTimeDelay=!1,this.isPath=function(e){return"/"===e[0]&&"/"!==e[1]},this.getSrc=function(e){return void 0!==window.__ezScriptHost&&this.isPath(e)&&"banger.js"!==this.name?window.__ezScriptHost+e:e},this.process=function(){l.isInitialized=!0,u("... file = "+e);var i=this.fWindow?this.fWindow.document:document,t=i.createElement("script");t.src=this.getSrc(this.path),!0===o?t.async=!0:!0===r&&(t.defer=!0),t.onerror=function(){var e={url:window.location.href,name:l.name,path:l.path,user_agent:window.navigator.userAgent};"undefined"!=typeof _ezaq&&(e.pageview_id=_ezaq.page_view_id);var i=encodeURIComponent(JSON.stringify(e)),t=new XMLHttpRequest;t.open("GET","//g.ezoic.net/ezqlog?d="+i,!0),t.send(),u("----- ERR'D: "+l.name),l.isError=!0,!0===l.isBlock&&m()},t.onreadystatechange=t.onload=function(){var e=t.readyState;u("----- F'D: "+l.name),e&&!/loaded|complete/.test(e)||(l.isComplete=!0,!0===l.isBlock&&m())},i.getElementsByTagName("head")[0].appendChild(t)}},d=function(e,i){this.name=e,this.path="",this.async=!1,this.defer=!1,this.isBlock=!1,this.blockedBy=[],this.isInitialized=!0,this.isError=!1,this.isComplete=i,this.proceedIfError=!1,this.isTimeDelay=!1,this.process=function(){}};function c(e,i,n,s,a,d,c,f,u){var m=new l(e,i,n,s,a,d,c,u);!0===f?o[e]=m:r[e]=m,t[e]=m,h(m)}function h(e){!0!==f(e)&&0!=s&&e.process()}function f(e){if(!0===e.isTimeDelay&&!1===n)return u(e.name+" blocked = TIME DELAY!"),!0;if(w(e.blockedBy))for(var i=0;i<e.blockedBy.length;i++){var o=e.blockedBy[i];if(!1===t.hasOwnProperty(o))return u(e.name+" blocked = "+o),!0;if(!0===e.proceedIfError&&!0===t[o].isError)return!1;if(!1===t[o].isComplete)return u(e.name+" blocked = "+o),!0}return!1}function u(e){var i=window.location.href,t=new RegExp("[?&]ezq=([^&#]*)","i").exec(i);"1"===(t?t[1]:null)&&console.debug(e)}function m(){++e>200||(u("let's go"),p(o),p(r))}function p(e){for(var i in e)if(!1!==e.hasOwnProperty(i)){var t=e[i];!0===t.isComplete||f(t)||!0===t.isInitialized||!0===t.isError?!0===t.isError?u(t.name+": error"):!0===t.isComplete?u(t.name+": complete already"):!0===t.isInitialized&&u(t.name+": initialized already"):t.process()}}function w(e){return"[object Array]"==Object.prototype.toString.call(e)}return window.addEventListener("load",(function(){setTimeout((function(){n=!0,u("TDELAY -----"),m()}),5e3)}),!1),{addFile:c,addFileOnce:function(e,i,n,o,r,s,a,l,d){t[e]||c(e,i,n,o,r,s,a,l,d)},addDelayFile:function(e,i){var n=new l(e,i,!1,[],!1,!1,!0);n.isTimeDelay=!0,u(e+" ...  FILE! TDELAY"),r[e]=n,t[e]=n,h(n)},addFunc:function(e,n,s,l,d,c,f,u,m,p){!0===c&&(e=e+"_"+i++);var w=new a(e,n,s,l,d,f,u,p);!0===m?o[e]=w:r[e]=w,t[e]=w,h(w)},addDelayFunc:function(e,i,n){var o=new a(e,i,n,!1,[],!0,!0);o.isTimeDelay=!0,u(e+" ...  FUNCTION! TDELAY"),r[e]=o,t[e]=o,h(o)},items:t,processAll:m,setallowLoad:function(e){s=e},markLoaded:function(e){if(e&&0!==e.length){if(e in t){var i=t[e];!0===i.isComplete?u(i.name+" "+e+": error loaded duplicate"):(i.isComplete=!0,i.isInitialized=!0)}else t[e]=new d(e,!0);u("markLoaded dummyfile: "+t[e].name)}},logWhatsBlocked:function(){for(var e in t)!1!==t.hasOwnProperty(e)&&f(t[e])}}}();__ez.evt.add=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n()},__ez.evt.remove=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):delete e["on"+t]};__ez.script.add=function(e){var t=document.createElement("script");t.src=e,t.async=!0,t.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(t)};__ez.dot={};__ez.queue.addFile('/detroitchicago/boise.js', '/detroitchicago/boise.js?gcb=195-2&cb=5', true, [], true, false, true, false);__ez.queue.addFile('/parsonsmaize/abilene.js', '/parsonsmaize/abilene.js?gcb=195-2&cb=35', true, [], true, false, true, false);</script><script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/boise.js.download" async=""></script><script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/abilene.js.download" async=""></script>
<script data-ezscrex="false" data-cfasync="false">__ez.ssaf=[];__ez.sswp=4;__ez.ssv=69178;__ez.sshsdef=false;</script>
<script data-ezscrex="false" data-cfasync="false">(function(){if("function"===typeof window.CustomEvent)return!1;window.CustomEvent=function(c,a){a=a||{bubbles:!1,cancelable:!1,detail:null};var b=document.createEvent("CustomEvent");b.initCustomEvent(c,a.bubbles,a.cancelable,a.detail);return b}})();</script><script data-ezscrex="false" data-cfasync="false">__ez.queue.addFile('/detroitchicago/tulsa.js', '/detroitchicago/tulsa.js?gcb=195-2&cb=9', false, [], true, false, true, false);</script><script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/tulsa.js.download" async=""></script>
<script data-ezscrex="false" type="text/javascript" data-cfasync="false">window._ezaq = Object.assign({}, typeof window._ezaq !== "undefined" ? window._ezaq : {}, {"ad_cache_level":1,"adpicker_placement_cnt":7,"ai_placeholder_cache_level":1,"ai_placeholder_placement_cnt":-1,"article_category":"Machine Learning, Computer Visio","author":"Yacine Rouizi","domain_id":195154,"ezcache_level":0,"ezcache_skip_code":0,"has_bad_image":0,"has_bad_words":0,"is_sitespeed":1,"lt_cache_level":0,"publish_date":"2023-08-03","response_size":111741,"response_size_orig":103576,"response_time_orig":151,"template_id":134,"url":"https://thepythoncode.com/article/real-time-vehicle-tracking-and-counting-with-yolov8-opencv","word_count":4529,"worst_bad_word_level":0});__ez.queue.markLoaded('ezaqBaseReady');</script>
<link rel="preconnect" href="https://thepythoncode.com/" crossorigin="">
<link rel="preconnect" href="https://www.googletagmanager.com/" crossorigin="">
<link rel="preconnect" href="https://fonts.googleapis.com/" crossorigin="">
<link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">
<link rel="preconnect" href="https://cdn.jsdelivr.net/" crossorigin="">
<link rel="preconnect" href="https://cdnjs.cloudflare.com/" crossorigin="">
<link rel="preconnect" href="https://www.google.com/" crossorigin="">
<link rel="preconnect" href="https://www.youtube.com/" crossorigin="">
<link rel="preconnect" href="https://go.ezoic.net/" crossorigin="">
<link rel="preload" as="script" href="https://securepubads.g.doubleclick.net/tag/js/gpt.js">
<link rel="preload" as="script" href="https://go.ezodn.com/hb/dall.js?cb=195-2-102">
<script type="text/javascript">(function(){function storageAvailable(type){var storage;try{storage=window[type];var x='__storage_test__';storage.setItem(x,x);storage.removeItem(x);return true;}
catch(e){return e instanceof DOMException&&(e.code===22||e.code===1014||e.name==='QuotaExceededError'||e.name==='NS_ERROR_DOM_QUOTA_REACHED')&&(storage&&storage.length!==0);}}
function remove_ama_config(){if(storageAvailable('localStorage')){localStorage.removeItem("google_ama_config");}}
remove_ama_config()})()</script>
<script type="text/javascript">var ezoicTestActive = true</script>
<script type="text/javascript" data-ezscrex="false" data-cfasync="false">
window.ezAnalyticsStatic = true;

function analyticsAddScript(script) {
	var ezDynamic = document.createElement('script');
	ezDynamic.type = 'text/javascript';
	ezDynamic.innerHTML = script;
	document.head.appendChild(ezDynamic);
}
function getCookiesWithPrefix() {
    var allCookies = document.cookie.split(';');
    var cookiesWithPrefix = {};

    for (var i = 0; i < allCookies.length; i++) {
        var cookie = allCookies[i].trim();

        for (var j = 0; j < arguments.length; j++) {
            var prefix = arguments[j];
            if (cookie.indexOf(prefix) === 0) {
                var cookieParts = cookie.split('=');
                var cookieName = cookieParts[0];
                var cookieValue = cookieParts.slice(1).join('=');
                cookiesWithPrefix[cookieName] = decodeURIComponent(cookieValue);
                break; // Once matched, no need to check other prefixes
            }
        }
    }

    return cookiesWithPrefix;
}
function productAnalytics() {
	var d = {"ab":"mod134","pr":[4,2,1],"aop":{"12":0,"14":0,"21":0,"4":134,"8":0}};
	d.u = _ezaq.url;
	d.p = _ezaq.page_view_id;
	d.v = _ezaq.visit_uuid;
	d.e = JSON.stringify(_ezaq);
	d.ref = document.referrer;
	d.c = getCookiesWithPrefix('active_template', 'ez', 'lp_');

	var dataText = JSON.stringify(d);
	var xhr = new XMLHttpRequest();
	xhr.open('POST','/ezais/analytics?cb=1', true);
	xhr.onload = function () {
		if (xhr.status!=200) {
            return;
		}

        if(document.readyState !== 'loading') {
            analyticsAddScript(xhr.response);
            return;
        }

        var eventFunc = function() {
            if(document.readyState === 'loading') {
                return;
            }
            document.removeEventListener('readystatechange', eventFunc, false);
            analyticsAddScript(xhr.response);
        };

        document.addEventListener('readystatechange', eventFunc, false);
	};
	xhr.setRequestHeader('Content-Type','text/plain');
	xhr.send(dataText);
}
__ez.queue.addFunc("productAnalytics", "productAnalytics", null, true, ['ezaqBaseReady'], false, false, false, true);
</script><script type="text/javascript" data-ezscrex="false" data-cfasync="false" async="">
function productEzoicAds() {
window.google_reactive_ads_global_state = {
                adCount: {},
                floatingAdsStacking: { maxZIndexListeners: [], maxZIndexRestrictions: {}, nextRestrictionId: 0 },
                messageValidationEnabled: false,
                reactiveTypeDisabledByPublisher: {},
                reactiveTypeEnabledInAsfe: {},
                sideRailAvailableSpace: [],
                sideRailOverlappableElements: [],
                stateForType: {},
                tagSpecificState: {},
                wasPlaTagProcessed: true,
                wasReactiveAdConfigReceived: { 1: true, 2: true, 8: true },
                wasReactiveAdVisible: {},
                wasReactiveTagRequestSent: true,
                description: "Can't disable auto ads programmatically on the page, so here we are!"
            };
var d = {"ab":"","km":{},"pv":"","vu":"f93c081a-988d-4872-5f5f-c9046fca432a","r":{"r":[{"p":" ezoic_pub_ad_placeholder-106-top_of_page-120x240-106-nonexxxnonexxxxxxezmaxscaleval100 ","s":106},{"p":" ezoic_pub_ad_placeholder-106-top_of_page-125x125-106-nonexxxnonexxxxxxezmaxscaleval100 ","s":106},{"p":" ezoic_pub_ad_placeholder-106-top_of_page-180x150-106-nonexxxnonexxxxxxezmaxscaleval100 ","s":106},{"p":" ezoic_pub_ad_placeholder-106-top_of_page-200x200-106-nonexxxnonexxxxxxezmaxscaleval100 ","s":106},{"p":" ezoic_pub_ad_placeholder-106-top_of_page-234x60-106-nonexxxnonexxxxxxezmaxscaleval100 ","s":106},{"p":" ezoic_pub_ad_placeholder-106-top_of_page-250x250-106-nonexxxnonexxxxxxezmaxscaleval100 ","s":106},{"p":" ezoic_pub_ad_placeholder-106-top_of_page-300x250-106-nonexxxnonexxxxxxezmaxscaleval100 ","s":106},{"p":" ezoic_pub_ad_placeholder-106-top_of_page-320x100-106-nonexxxnonexxxxxxezmaxscaleval100 ","s":106},{"p":" ezoic_pub_ad_placeholder-106-top_of_page-300x50v2-106-nonexxxnonexxxxxxezmaxscaleval100 ","s":106},{"p":" ezoic_pub_ad_placeholder-106-top_of_page-320x50-106-nonexxxnonexxxxxxezmaxscaleval100 ","s":106},{"p":" ezoic_pub_ad_placeholder-106-top_of_page-336x280-106-nonexxxnonexxxxxxezmaxscaleval100 ","s":106},{"p":" ezoic_pub_ad_placeholder-106-top_of_page-320x100v2-106-nonexxxnonexxxxxxezmaxscaleval100 ","s":106},{"p":" ezoic_pub_ad_placeholder-106-top_of_page-468x60-106-nonexxxnonexxxxxxezmaxscaleval100 ","s":106},{"p":" ezoic_pub_ad_placeholder-106-top_of_page-728x90-106-nonexxxnonexxxxxxezmaxscaleval100 ","s":106},{"p":" ezoic_pub_ad_placeholder-106-top_of_page-970x250-106-nonexxxnonexxxxxxezmaxscaleval100 ","s":106},{"p":" ezoic_pub_ad_placeholder-106-top_of_page-300x250x3-106-nonexxxnonexxxxxxezmaxscaleval100 ","s":106},{"p":" ezoic_pub_ad_placeholder-106-top_of_page-970x90-106-nonexxxnonexxxxxxezmaxscaleval100 ","s":106},{"p":" ezoic_pub_ad_placeholder-144-under_first_paragraph-120x240-144-nonexxxnonexxxxxxezmaxscaleval100 ","s":144},{"p":" ezoic_pub_ad_placeholder-144-under_first_paragraph-125x125-144-nonexxxnonexxxxxxezmaxscaleval100 ","s":144},{"p":" ezoic_pub_ad_placeholder-144-under_first_paragraph-180x150-144-nonexxxnonexxxxxxezmaxscaleval100 ","s":144},{"p":" ezoic_pub_ad_placeholder-144-under_first_paragraph-200x200-144-nonexxxnonexxxxxxezmaxscaleval100 ","s":144},{"p":" ezoic_pub_ad_placeholder-144-under_first_paragraph-234x60-144-nonexxxnonexxxxxxezmaxscaleval100 ","s":144},{"p":" ezoic_pub_ad_placeholder-144-under_first_paragraph-250x250-144-nonexxxnonexxxxxxezmaxscaleval100 ","s":144},{"p":" ezoic_pub_ad_placeholder-144-under_first_paragraph-300x250-144-nonexxxnonexxxxxxezmaxscaleval100 ","s":144},{"p":" ezoic_pub_ad_placeholder-144-under_first_paragraph-320x100-144-nonexxxnonexxxxxxezmaxscaleval100 ","s":144},{"p":" ezoic_pub_ad_placeholder-144-under_first_paragraph-300x50v2-144-nonexxxnonexxxxxxezmaxscaleval100 ","s":144},{"p":" ezoic_pub_ad_placeholder-144-under_first_paragraph-320x50-144-nonexxxnonexxxxxxezmaxscaleval100 ","s":144},{"p":" ezoic_pub_ad_placeholder-144-under_first_paragraph-336x280-144-nonexxxnonexxxxxxezmaxscaleval100 ","s":144},{"p":" ezoic_pub_ad_placeholder-144-under_first_paragraph-320x100v2-144-nonexxxnonexxxxxxezmaxscaleval100 ","s":144},{"p":" ezoic_pub_ad_placeholder-144-under_first_paragraph-468x60-144-nonexxxnonexxxxxxezmaxscaleval100 ","s":144},{"p":" ezoic_pub_ad_placeholder-144-under_first_paragraph-580x400-144-nonexxxnonexxxxxxezmaxscaleval100 ","s":144},{"p":" ezoic_pub_ad_placeholder-144-under_first_paragraph-250x250x2-144-nonexxxnonexxxxxxezmaxscaleval100 ","s":144},{"p":" ezoic_pub_ad_placeholder-144-under_first_paragraph-728x90-144-nonexxxnonexxxxxxezmaxscaleval100 ","s":144},{"p":" ezoic_pub_ad_placeholder-144-under_first_paragraph-970x250-144-nonexxxnonexxxxxxezmaxscaleval100 ","s":144},{"p":" ezoic_pub_ad_placeholder-144-under_first_paragraph-300x250x3-144-nonexxxnonexxxxxxezmaxscaleval100 ","s":144},{"p":" ezoic_pub_ad_placeholder-144-under_first_paragraph-970x90-144-nonexxxnonexxxxxxezmaxscaleval100 ","s":144},{"p":" ezoic_pub_ad_placeholder-107-under_second_paragraph-120x240-107-nonexxxnonexxxxxxezmaxscaleval100 ","s":107},{"p":" ezoic_pub_ad_placeholder-107-under_second_paragraph-125x125-107-nonexxxnonexxxxxxezmaxscaleval100 ","s":107},{"p":" ezoic_pub_ad_placeholder-107-under_second_paragraph-180x150-107-nonexxxnonexxxxxxezmaxscaleval100 ","s":107},{"p":" ezoic_pub_ad_placeholder-107-under_second_paragraph-200x200-107-nonexxxnonexxxxxxezmaxscaleval100 ","s":107},{"p":" ezoic_pub_ad_placeholder-107-under_second_paragraph-234x60-107-nonexxxnonexxxxxxezmaxscaleval100 ","s":107},{"p":" ezoic_pub_ad_placeholder-107-under_second_paragraph-250x250-107-nonexxxnonexxxxxxezmaxscaleval100 ","s":107},{"p":" ezoic_pub_ad_placeholder-107-under_second_paragraph-300x250-107-nonexxxnonexxxxxxezmaxscaleval100 ","s":107},{"p":" ezoic_pub_ad_placeholder-107-under_second_paragraph-320x100-107-nonexxxnonexxxxxxezmaxscaleval100 ","s":107},{"p":" ezoic_pub_ad_placeholder-107-under_second_paragraph-300x50v2-107-nonexxxnonexxxxxxezmaxscaleval100 ","s":107},{"p":" ezoic_pub_ad_placeholder-107-under_second_paragraph-320x50-107-nonexxxnonexxxxxxezmaxscaleval100 ","s":107},{"p":" ezoic_pub_ad_placeholder-107-under_second_paragraph-336x280-107-nonexxxnonexxxxxxezmaxscaleval100 ","s":107},{"p":" ezoic_pub_ad_placeholder-107-under_second_paragraph-320x100v2-107-nonexxxnonexxxxxxezmaxscaleval100 ","s":107},{"p":" ezoic_pub_ad_placeholder-107-under_second_paragraph-468x60-107-nonexxxnonexxxxxxezmaxscaleval100 ","s":107},{"p":" ezoic_pub_ad_placeholder-107-under_second_paragraph-728x90-107-nonexxxnonexxxxxxezmaxscaleval100 ","s":107},{"p":" ezoic_pub_ad_placeholder-107-under_second_paragraph-970x250-107-nonexxxnonexxxxxxezmaxscaleval100 ","s":107},{"p":" ezoic_pub_ad_placeholder-107-under_second_paragraph-300x250x3-107-nonexxxnonexxxxxxezmaxscaleval100 ","s":107},{"p":" ezoic_pub_ad_placeholder-107-under_second_paragraph-970x90-107-nonexxxnonexxxxxxezmaxscaleval100 ","s":107},{"p":" ezoic_pub_ad_placeholder-108-mid_content-120x240-108-nonexxxnonexxxxxxezmaxscaleval100 ","s":108},{"p":" ezoic_pub_ad_placeholder-108-mid_content-125x125-108-nonexxxnonexxxxxxezmaxscaleval100 ","s":108},{"p":" ezoic_pub_ad_placeholder-108-mid_content-180x150-108-nonexxxnonexxxxxxezmaxscaleval100 ","s":108},{"p":" ezoic_pub_ad_placeholder-108-mid_content-200x200-108-nonexxxnonexxxxxxezmaxscaleval100 ","s":108},{"p":" ezoic_pub_ad_placeholder-108-mid_content-234x60-108-nonexxxnonexxxxxxezmaxscaleval100 ","s":108},{"p":" ezoic_pub_ad_placeholder-108-mid_content-250x250-108-nonexxxnonexxxxxxezmaxscaleval100 ","s":108},{"p":" ezoic_pub_ad_placeholder-108-mid_content-300x250-108-nonexxxnonexxxxxxezmaxscaleval100 ","s":108},{"p":" ezoic_pub_ad_placeholder-108-mid_content-320x100-108-nonexxxnonexxxxxxezmaxscaleval100 ","s":108},{"p":" ezoic_pub_ad_placeholder-108-mid_content-300x50v2-108-nonexxxnonexxxxxxezmaxscaleval100 ","s":108},{"p":" ezoic_pub_ad_placeholder-108-mid_content-320x50-108-nonexxxnonexxxxxxezmaxscaleval100 ","s":108},{"p":" ezoic_pub_ad_placeholder-108-mid_content-336x280-108-nonexxxnonexxxxxxezmaxscaleval100 ","s":108},{"p":" ezoic_pub_ad_placeholder-108-mid_content-320x100v2-108-nonexxxnonexxxxxxezmaxscaleval100 ","s":108},{"p":" ezoic_pub_ad_placeholder-108-mid_content-468x60-108-nonexxxnonexxxxxxezmaxscaleval100 ","s":108},{"p":" ezoic_pub_ad_placeholder-108-mid_content-580x400-108-nonexxxnonexxxxxxezmaxscaleval100 ","s":108},{"p":" ezoic_pub_ad_placeholder-108-mid_content-250x250x2-108-nonexxxnonexxxxxxezmaxscaleval100 ","s":108},{"p":" ezoic_pub_ad_placeholder-108-mid_content-728x90-108-nonexxxnonexxxxxxezmaxscaleval100 ","s":108},{"p":" ezoic_pub_ad_placeholder-108-mid_content-970x250-108-nonexxxnonexxxxxxezmaxscaleval100 ","s":108},{"p":" ezoic_pub_ad_placeholder-108-mid_content-300x250x3-108-nonexxxnonexxxxxxezmaxscaleval100 ","s":108},{"p":" ezoic_pub_ad_placeholder-108-mid_content-970x90-108-nonexxxnonexxxxxxezmaxscaleval100 ","s":108},{"p":" ezoic_pub_ad_placeholder-901-under_page_title-250x250-901-nonexxxnonexxxxxxezmaxscaleval100 ","s":901},{"p":" ezoic_pub_ad_placeholder-901-under_page_title-300x250-901-nonexxxnonexxxxxxezmaxscaleval100 ","s":901},{"p":" ezoic_pub_ad_placeholder-901-under_page_title-320x100-901-nonexxxnonexxxxxxezmaxscaleval100 ","s":901},{"p":" ezoic_pub_ad_placeholder-901-under_page_title-300x50v2-901-nonexxxnonexxxxxxezmaxscaleval100 ","s":901},{"p":" ezoic_pub_ad_placeholder-901-under_page_title-320x50-901-nonexxxnonexxxxxxezmaxscaleval100 ","s":901},{"p":" ezoic_pub_ad_placeholder-901-under_page_title-336x280-901-nonexxxnonexxxxxxezmaxscaleval100 ","s":901},{"p":" ezoic_pub_ad_placeholder-901-under_page_title-320x100v2-901-nonexxxnonexxxxxxezmaxscaleval100 ","s":901},{"p":" ezoic_pub_ad_placeholder-901-under_page_title-468x60-901-nonexxxnonexxxxxxezmaxscaleval100 ","s":901},{"p":" ezoic_pub_ad_placeholder-901-under_page_title-728x90-901-nonexxxnonexxxxxxezmaxscaleval100 ","s":901},{"p":" ezoic_pub_ad_placeholder-109-long_content-120x240-109-nonexxxnonexxxxxxezmaxscaleval100 ","s":109},{"p":" ezoic_pub_ad_placeholder-109-long_content-125x125-109-nonexxxnonexxxxxxezmaxscaleval100 ","s":109},{"p":" ezoic_pub_ad_placeholder-109-long_content-180x150-109-nonexxxnonexxxxxxezmaxscaleval100 ","s":109},{"p":" ezoic_pub_ad_placeholder-109-long_content-200x200-109-nonexxxnonexxxxxxezmaxscaleval100 ","s":109},{"p":" ezoic_pub_ad_placeholder-109-long_content-234x60-109-nonexxxnonexxxxxxezmaxscaleval100 ","s":109},{"p":" ezoic_pub_ad_placeholder-109-long_content-250x250-109-nonexxxnonexxxxxxezmaxscaleval100 ","s":109},{"p":" ezoic_pub_ad_placeholder-109-long_content-300x250-109-nonexxxnonexxxxxxezmaxscaleval100 ","s":109},{"p":" ezoic_pub_ad_placeholder-109-long_content-320x100-109-nonexxxnonexxxxxxezmaxscaleval100 ","s":109},{"p":" ezoic_pub_ad_placeholder-109-long_content-300x50v2-109-nonexxxnonexxxxxxezmaxscaleval100 ","s":109},{"p":" ezoic_pub_ad_placeholder-109-long_content-320x50-109-nonexxxnonexxxxxxezmaxscaleval100 ","s":109},{"p":" ezoic_pub_ad_placeholder-109-long_content-336x280-109-nonexxxnonexxxxxxezmaxscaleval100 ","s":109},{"p":" ezoic_pub_ad_placeholder-109-long_content-320x100v2-109-nonexxxnonexxxxxxezmaxscaleval100 ","s":109},{"p":" ezoic_pub_ad_placeholder-109-long_content-468x60-109-nonexxxnonexxxxxxezmaxscaleval100 ","s":109},{"p":" ezoic_pub_ad_placeholder-109-long_content-580x400-109-nonexxxnonexxxxxxezmaxscaleval100 ","s":109},{"p":" ezoic_pub_ad_placeholder-109-long_content-250x250x2-109-nonexxxnonexxxxxxezmaxscaleval100 ","s":109},{"p":" ezoic_pub_ad_placeholder-109-long_content-728x90-109-nonexxxnonexxxxxxezmaxscaleval100 ","s":109},{"p":" ezoic_pub_ad_placeholder-109-long_content-970x250-109-nonexxxnonexxxxxxezmaxscaleval100 ","s":109},{"p":" ezoic_pub_ad_placeholder-109-long_content-300x250x3-109-nonexxxnonexxxxxxezmaxscaleval100 ","s":109},{"p":" ezoic_pub_ad_placeholder-109-long_content-970x90-109-nonexxxnonexxxxxxezmaxscaleval100 ","s":109},{"p":" ezoic_pub_ad_placeholder-149-sidebar-120x240-149-nonexxxnonexxxxxxezmaxscaleval100 ","s":149},{"p":" ezoic_pub_ad_placeholder-149-sidebar-120x600-149-nonexxxnonexxxxxxezmaxscaleval100 ","s":149},{"p":" ezoic_pub_ad_placeholder-149-sidebar-125x125-149-nonexxxnonexxxxxxezmaxscaleval100 ","s":149},{"p":" ezoic_pub_ad_placeholder-149-sidebar-160x600-149-nonexxxnonexxxxxxezmaxscaleval100 ","s":149},{"p":" ezoic_pub_ad_placeholder-149-sidebar-180x150-149-nonexxxnonexxxxxxezmaxscaleval100 ","s":149},{"p":" ezoic_pub_ad_placeholder-149-sidebar-200x200-149-nonexxxnonexxxxxxezmaxscaleval100 ","s":149},{"p":" ezoic_pub_ad_placeholder-149-sidebar-250x250-149-nonexxxnonexxxxxxezmaxscaleval100 ","s":149},{"p":" ezoic_pub_ad_placeholder-149-sidebar-300x1050-149-nonexxxnonexxxxxxezmaxscaleval100 ","s":149},{"p":" ezoic_pub_ad_placeholder-149-sidebar-300x250v4-149-nonexxxnonexxxxxxezmaxscaleval100 ","s":149},{"p":" ezoic_pub_ad_placeholder-149-sidebar-300x250-149-nonexxxnonexxxxxxezmaxscaleval100 ","s":149},{"p":" ezoic_pub_ad_placeholder-149-sidebar-300x600-149-nonexxxnonexxxxxxezmaxscaleval100 ","s":149},{"p":" ezoic_pub_ad_placeholder-149-sidebar-300x250v2-149-nonexxxnonexxxxxxezmaxscaleval100 ","s":149},{"p":" ezoic_pub_ad_placeholder-149-sidebar-120x600x2-149-nonexxxnonexxxxxxezmaxscaleval100 ","s":149},{"p":" ezoic_pub_ad_placeholder-149-sidebar-320x100-149-nonexxxnonexxxxxxezmaxscaleval100 ","s":149},{"p":" ezoic_pub_ad_placeholder-149-sidebar-300x50v2-149-nonexxxnonexxxxxxezmaxscaleval100 ","s":149},{"p":" ezoic_pub_ad_placeholder-149-sidebar-320x50-149-nonexxxnonexxxxxxezmaxscaleval100 ","s":149},{"p":" ezoic_pub_ad_placeholder-149-sidebar-336x280-149-nonexxxnonexxxxxxezmaxscaleval100 ","s":149},{"p":" ezoic_pub_ad_placeholder-149-sidebar-320x100v2-149-nonexxxnonexxxxxxezmaxscaleval100 ","s":149},{"p":" ezoic_pub_ad_placeholder-117-sidebar_floating_1-120x240-117-nonexxxnonexxxxxxezmaxscaleval100 ","s":117},{"p":" ezoic_pub_ad_placeholder-117-sidebar_floating_1-120x600-117-nonexxxnonexxxxxxezmaxscaleval100 ","s":117},{"p":" ezoic_pub_ad_placeholder-117-sidebar_floating_1-125x125-117-nonexxxnonexxxxxxezmaxscaleval100 ","s":117},{"p":" ezoic_pub_ad_placeholder-117-sidebar_floating_1-160x600-117-nonexxxnonexxxxxxezmaxscaleval100 ","s":117},{"p":" ezoic_pub_ad_placeholder-117-sidebar_floating_1-180x150-117-nonexxxnonexxxxxxezmaxscaleval100 ","s":117},{"p":" ezoic_pub_ad_placeholder-117-sidebar_floating_1-200x200-117-nonexxxnonexxxxxxezmaxscaleval100 ","s":117},{"p":" ezoic_pub_ad_placeholder-117-sidebar_floating_1-250x250-117-nonexxxnonexxxxxxezmaxscaleval100 ","s":117},{"p":" ezoic_pub_ad_placeholder-117-sidebar_floating_1-300x250-117-nonexxxnonexxxxxxezmaxscaleval100 ","s":117},{"p":" ezoic_pub_ad_placeholder-117-sidebar_floating_1-300x600-117-nonexxxnonexxxxxxezmaxscaleval100 ","s":117},{"p":" ezoic_pub_ad_placeholder-117-sidebar_floating_1-300x250v2-117-nonexxxnonexxxxxxezmaxscaleval100 ","s":117},{"p":" ezoic_pub_ad_placeholder-117-sidebar_floating_1-120x600x2-117-nonexxxnonexxxxxxezmaxscaleval100 ","s":117},{"p":" ezoic_pub_ad_placeholder-117-sidebar_floating_1-320x100-117-nonexxxnonexxxxxxezmaxscaleval100 ","s":117},{"p":" ezoic_pub_ad_placeholder-117-sidebar_floating_1-300x50v2-117-nonexxxnonexxxxxxezmaxscaleval100 ","s":117},{"p":" ezoic_pub_ad_placeholder-117-sidebar_floating_1-320x50-117-nonexxxnonexxxxxxezmaxscaleval100 ","s":117},{"p":" ezoic_pub_ad_placeholder-117-sidebar_floating_1-336x280-117-nonexxxnonexxxxxxezmaxscaleval100 ","s":117},{"p":" ezoic_pub_ad_placeholder-117-sidebar_floating_1-320x100v2-117-nonexxxnonexxxxxxezmaxscaleval100 ","s":117},{"p":" ezoic_pub_ad_placeholder-100-bottom_floating-728x90-100-nonexxxnonexxxxxxezmaxscaleval100 ","s":100},{"p":" ezoic_pub_ad_placeholder-100-bottom_floating-970x90-100-nonexxxnonexxxxxxezmaxscaleval100 ","s":100}],"a":{"100":true,"106":true,"107":true,"108":true,"109":true,"117":true,"144":true,"149":true,"6":true,"901":true},"g":-1,"l":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"m":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"v":0,"ve":false,"hr":false},"tid":134,"tn":"pub_site","url":"https://thepythoncode.com/article/real-time-vehicle-tracking-and-counting-with-yolov8-opencv","wc":4529,"ff":1,"dhh":""};
d.ab = _ezaq.ab_test_id;
d.pv = _ezaq.page_view_id;
d.vu = _ezaq.visit_uuid;
var dynamicAddScript = function(script) {
	if(window.ezFinishedStatic === true) {
		console.error("attempted to load dynamic script again");
		return;
	}
	var errorMessages = [];
	function errorHandler(event) {
	  var errorObj = event.error;
	  if (errorObj && errorObj.stack && errorObj.stack.indexOf('dynamicAddScript') !== -1) {
		var errorMessage = {
		  Message: event.message,
		  LineNo: event.lineno,
		  ColumnNo: event.colno,
		  Stack: errorObj.stack
		};
		errorMessages.push(errorMessage);
	  }

	  if (typeof window.onerror === 'function') {
		window.onerror.apply(this, arguments);
	  }
	}
 	window.addEventListener('error', errorHandler);

	var ezDynamic = document.createElement('script');
	ezDynamic.type = 'text/javascript';
	ezDynamic.innerHTML = script;
	document.head.appendChild(ezDynamic);

	window.removeEventListener('error', errorHandler);
	if (window.ezFinishedStatic !== true || typeof window.ezstaticerrors !== 'undefined') {
		d.Script = script;
		d.ErrorMessages = JSON.stringify(errorMessages);
		d.ErrorStaticMessages = window.ezstaticerrors || '';
		var dataTxt = JSON.stringify(d);
		if (dataTxt.length > 0) {
			var logXHR = new XMLHttpRequest()
			logXHR.open('POST','/ezais/log?cb=1', true);
			logXHR.setRequestHeader('Content-Type','application/json');
			logXHR.send(dataTxt);
		}
	}
};
var dataText = JSON.stringify(d);
if (dataText.length > 0) {
	var startTime = Date.now() - __ez.stms;

	var xhr = new XMLHttpRequest();
	xhr.open('POST','/ezais/dynamic?cb=1', true);
	xhr.onload = function () {
		if (xhr.status!=200) {
            return;
		}

        if(document.readyState !== 'loading') {
            dynamicAddScript(xhr.response);
            return;
        }

        var eventFunc = function() {
            if(document.readyState === 'loading') {
                return;
            }
            document.removeEventListener('readystatechange', eventFunc, false);
            dynamicAddScript(xhr.response);
        };

        document.addEventListener('readystatechange', eventFunc, false);
	};
	xhr.setRequestHeader('Content-Type','text/plain');
	xhr.send(dataText);
}
}
__ez.queue.addFunc("productEzoicAds", "productEzoicAds", null, true, ['ezaqReady'], false, false, false, true);
</script><!--<base href="https://thepythoncode.com/article/real-time-vehicle-tracking-and-counting-with-yolov8-opencv">--><base href=".">
    
    
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script async="" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/js"></script>
    
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-4HYHLZBXLP');
    </script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com/">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">
    <link href="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/css2" rel="stylesheet">
    <link rel="shortcut icon" href="https://thepythoncode.com/static/img/python_logo.ico">
    <link href="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <link rel="stylesheet" href="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/prism.css">
    <script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/bootstrap.min.js.download" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/clean-blog.css">
    <link rel="stylesheet" href="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/promo-card.css">
    <style>
        .grecaptcha-badge { 
            visibility: hidden !important;
            right: 0px !important;
        } 
    </style>
    
<title>Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code</title>
<meta name="description" content="Learn how to perform vehicle detection, tracking and counting with YOLOv8 and DeepSORT using OpenCV library in Python.">

<meta name="author" content="Yacine Rouizi">

<meta name="date" content="2023-08-03T09:32:20.660890+00:00">
<meta name="category" content="Machine Learning, Computer Vision">
<meta property="og:url" content="https://thepythoncode.com/article/real-time-vehicle-tracking-and-counting-with-yolov8-opencv">
<meta property="og:type" content="website">
<meta property="og:title" content="Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code">
<meta property="og:description" content="Learn how to perform vehicle detection, tracking and counting with YOLOv8 and DeepSORT using OpenCV library in Python.">
<meta property="og:image" content="https://thepythoncode.com/media/articles/trajectories-drawn-on-the-frame.webp">
<meta property="og:image:width" content="600">
<meta property="og:image:height" content="315">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ThePythonCode1">
<meta name="twitter:title" content="Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code">
<meta name="twitter:description" content="Learn how to perform vehicle detection, tracking and counting with YOLOv8 and DeepSORT using OpenCV library in Python.">
<meta name="twitter:image" content="https://thepythoncode.com/media/articles/trajectories-drawn-on-the-frame.webp">
<meta name="twitter:image:alt" content="Real-Time Vehicle Detection, Tracking and Counting in Python">
<script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/api.js.download" async="" defer=""></script>
<script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/api(1).js.download" async="" defer=""></script>
<script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/api(2).js.download" async="" defer=""></script>
<script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/api(3).js.download" async="" defer=""></script>
<script type="text/javascript">
  document.addEventListener('DOMContentLoaded', function() {
    var onloadCallback = function() {
      if (typeof grecaptcha === 'undefined' || typeof grecaptcha.render ==='undefined') {
        setTimeout(onloadCallback, 100);
      } else {
        grecaptcha.render('html_element', {
          'sitekey' : '6LeWm7sUAAAAAAoyi0xFwTjfRWDi8lac_YxPJVxZ'
        });
      }
    };
    var onloadCallback2 = function() {
      if (typeof grecaptcha === 'undefined' || typeof grecaptcha.render ==='undefined') {
        setTimeout(onloadCallback2, 100);
      } else {
        grecaptcha.render('sidebar-button', {
          'sitekey' : '6LdFTfgoAAAAAPs7nop43W6L6XwiMhoIDeAVquUs'
        });
      }
    };
    var onloadCallback3 = function() {
      if (typeof grecaptcha === 'undefined' || typeof grecaptcha.render ==='undefined') {
        setTimeout(onloadCallback3, 100);
      } else {
        grecaptcha.render('footer-button', {
          'sitekey' : '6LdFTfgoAAAAAPs7nop43W6L6XwiMhoIDeAVquUs'
        });
      }
    };
    var onloadCallback4 = function() {
        if (typeof grecaptcha === 'undefined' || typeof grecaptcha.render ==='undefined') {
            setTimeout(onloadCallback4, 100);
        } else {
            try {
                grecaptcha.render('modal-button', {
                    'sitekey': '6LdFTfgoAAAAAPs7nop43W6L6XwiMhoIDeAVquUs'
                });
            } catch (error) {}
        }
    };
    // call them
    onloadCallback();
    onloadCallback2();
    onloadCallback3();
    onloadCallback4();
  });
</script>
<style>pre .language-python {font-size: 15px;}</style>

<script type="text/javascript">
var ezoTemplate = 'pub_site';
var ezouid = '1';
var ezoFormfactor = '1';
</script><script data-ezscrex="false" type="text/javascript">
var soc_app_id = '0';
var did = 195154;
var ezdomain = 'thepythoncode.com';
var ezoicSearchable = 1;
</script>
<script data-cfasync="false">__ez.queue.addFile('/tardisrocinante/lazy_load.js', '/tardisrocinante/lazy_load.js?gcb=2&cb=6', false, [], true, false, true, false);</script><script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/lazy_load.js.download" async=""></script>
<link rel="canonical" href="https://www.thepythoncode.com/article/real-time-vehicle-tracking-and-counting-with-yolov8-opencv"><script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/clipboard.min.js.download"></script><script type="text/javascript">function _setEzCookies(ezConsentData){var cookies=[{name:"ezoab_195154",value:"mod134; Path=/; Domain=thepythoncode.com; Expires=Tue, 20 Aug 2024 21:45:40 UTC",tcfCategory:"store_info",isEzoic:"true",},{name:"ezoadgid_195154",value:"-1; Path=/; Domain=thepythoncode.com; Expires=Tue, 20 Aug 2024 20:15:40 UTC",tcfCategory:"understand_audiences",isEzoic:"true",},{name:"ezosuibasgeneris-1",value:"f22f4796-a7c1-4434-6cc7-ac5035f29196; Path=/; Domain=thepythoncode.com; Expires=Wed, 20 Aug 2025 19:45:40 UTC; Secure; SameSite=None",tcfCategory:"understand_audiences",isEzoic:"true",},{name:"lp_195154",value:"https://thepythoncode.com/article/real-time-vehicle-tracking-and-counting-with-yolov8-opencv; Path=/; Domain=thepythoncode.com; Expires=Tue, 20 Aug 2024 20:15:40 UTC",tcfCategory:"store_info",isEzoic:"true",},{name:"ezovuuidtime_195154",value:"1724183140; Path=/; Domain=thepythoncode.com; Expires=Thu, 22 Aug 2024 19:45:40 UTC",tcfCategory:"understand_audiences",isEzoic:"true",},{name:"ezovuuid_195154",value:"da8711ad-7d11-4d4a-7cc3-63900d43e185; Path=/; Domain=thepythoncode.com; Expires=Tue, 20 Aug 2024 20:15:40 UTC",tcfCategory:"understand_audiences",isEzoic:"true",},{name:"ezoref_195154",value:"google.com; Path=/; Domain=thepythoncode.com; Expires=Tue, 20 Aug 2024 20:15:40 UTC",tcfCategory:"understand_audiences",isEzoic:"true",}];for(var i=0;i<cookies.length;i++){var cookie=cookies[i];if(ezConsentData&&ezConsentData.loaded&&ezConsentData[cookie.tcfCategory]){document.cookie=cookie.name+"="+cookie.value;}}}
if(window.ezTcfConsent&&window.ezTcfConsent.loaded){_setEzCookies(window.ezTcfConsent);}else if(typeof getEzConsentData==="function"){getEzConsentData().then(function(ezTcfConsent){if(ezTcfConsent&&ezTcfConsent.loaded){_setEzCookies(window.ezTcfConsent);}else{console.error("cannot get ez consent data");_setEzCookies(window.ezTcfConsent);}});}else{console.error("getEzConsentData is not a function");_setEzCookies(window.ezTcfConsent);}window._ezaq = Object.assign({}, typeof window._ezaq !== "undefined" ? window._ezaq : {}, {"ab_test_id":"mod134","ad_cache_level":1,"ad_count_adjustment":0,"ad_lazyload_version":0,"ad_load_version":1,"ad_location_ids":"","adpicker_placement_cnt":7,"adx_ad_count":0,"ai_placeholder_cache_level":1,"ai_placeholder_placement_cnt":-1,"article_category":"Machine Learning, Computer Visio","author":"Yacine Rouizi","bidder_method":0,"bidder_version":3,"city":"Los Angeles","country":"US","days_since_last_visit":-1,"display_ad_count":0,"domain_id":195154,"domain_test_group":20230805,"ds_adsize_opt_id":-1,"engaged_time_visit":0,"ezcache_level":0,"ezcache_skip_code":0,"form_factor_id":1,"framework_id":1,"has_bad_image":0,"has_bad_words":0,"iab_category":"","is_embed":false,"is_from_recommended_pages":false,"is_return_visitor":false,"is_sitespeed":1,"last_page_load":"","last_pageview_id":"","lt_cache_level":0,"max_ads":0,"metro_code":803,"optimization_version":0,"page_ad_positions":"","page_view_count":0,"page_view_id":"c9c98522-6dce-4eb0-5595-a683fb352970","position_selection_id":0,"postal_code":"90012","product_1":1,"product_2":1,"product_4":1,"product_5":1,"publish_date":"2023-08-03","pv_event_count":0,"referring_domain":"google.com","response_size":111741,"response_size_orig":103576,"response_time_orig":151,"serverid":"i-0b87b2ab60a5260a1","state":"CA","sub_page_ad_positions":"","t_epoch":1724183140,"template_id":134,"time_on_site_visit":0,"url":"https://thepythoncode.com/article/real-time-vehicle-tracking-and-counting-with-yolov8-opencv","visit_uuid":"da8711ad-7d11-4d4a-7cc3-63900d43e185","word_count":4529,"worst_bad_word_level":0});__ez.queue.markLoaded('ezaqReady');
__ez.queue.addFile('/parsonsmaize/mulvane.js', '/parsonsmaize/mulvane.js?gcb=195-2&cb=10', true, ['/parsonsmaize/abilene.js'], true, false, true, false);__ez.queue.addFile('/parsonsmaize/olathe.js', '/parsonsmaize/olathe.js?gcb=195-2&cb=25', false, ['/parsonsmaize/abilene.js','/parsonsmaize/mulvane.js'], true, false, true, false);__ez.queue.addFile('/porpoiseant/et.js', '/porpoiseant/et.js?gcb=195-2&cb=3', false, [], true, false, true, false);!function(){var e=function(e,i,t){var o=[],n=null;return{Add:function(t,d){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(__ez.dot.isDefined(t)&&__ez.dot.isValid(d))if(n==t&&o.length>0&&o[o.length-1].data.length+d.length<=5)o[o.length-1].data=o[o.length-1].data.concat(__ez.dot.dataToStr(d));else{var _={type:e,domain_id:__ez.dot.getDID(),t_epoch:__ez.dot.getEpoch(0),data:__ez.dot.dataToStr(d)};_[i]=t,a&&a.hasOwnProperty("impression_id")&&a.hasOwnProperty("ad_unit")&&(_.impression_id=a.impression_id.toString(),_.unit=a.ad_unit),o.push(_),n=t}},Fire:function(){if(void 0===document.visibilityState||"prerender"!==document.visibilityState){if(__ez.dot.isDefined(o)&&o.length>0)for(;o.length>0;){var e=5;e>o.length&&(e=o.length);var i=o.splice(0,e),n=__ez.dot.getURL(t)+"?orig="+(!0===__ez.template.isOrig?1:0)+"&v="+btoa(JSON.stringify(i));__ez.dot.Fire(n)}o=[]}}}};__ez.vep=e("video","video_impression_id","/detroitchicago/grapefruit.gif"),__ez.vaep=e("video-ad","video_ad_impression_id","/porpoiseant/lemon.gif"),__ez.osvaep=e("outstream-video-ad","video_ad_impression_id","/porpoiseant/tangerine.gif")}();
__ez.queue.addFile('/detroitchicago/wichita.js', '/detroitchicago/wichita.js?gcb=195-2&cb=12', false, ['/parsonsmaize/abilene.js'], true, false, true, false);__ez.queue.addFile('/detroitchicago/raleigh.js', '/detroitchicago/raleigh.js?gcb=195-2&cb=7', false, ['/parsonsmaize/abilene.js'], true, false, true, false);__ez.queue.addFile('/detroitchicago/vista.js', '/detroitchicago/vista.js?gcb=195-2&cb=6', false, ['/parsonsmaize/abilene.js'], true, false, true, false);
function create_ezolpl() {
	var d = new Date();
	d.setTime(d.getTime() + 365 * 24 * 60 * 60 * 1000);
	var expires = "expires=" + d.toUTCString();
	__ez.ck.setByCat(
	  "ezux_lpl_195154",
	  new Date().getTime() +
		"|" +
		_ezaq.page_view_id +
		"|" +
		_ezaq.is_return_visitor +
		"; " +
		expires,
	  "understand_audiences",
	  false
	);
  }
  function attach_ezolpl() {
	if (document.readyState === "complete") {
	  create_ezolpl();
	  return;
	}
	window.addEventListener("load", create_ezolpl);
  }  

__ez.queue.addFunc("attach_ezolpl", "attach_ezolpl", null, false, ['/detroitchicago/boise.js'], true, false, false, false);

__ez.queue.addFile('/tardisrocinante/vitals.js', '/tardisrocinante/vitals.js?gcb=2&cb=4', false, ['/parsonsmaize/mulvane.js'], true, false, true, false);
var _audins_dom="thepythoncode_com",_audins_did=195154;__ez.queue.addDelayFunc("audins.js","__ez.script.add", "//go.ezodn.com/detroitchicago/audins.js?cb=3");
__ez.queue.addFile('/beardeddragon/drake.js', '/beardeddragon/drake.js?gcb=2&cb=8', false, [], true, false, true, false);
var __ez_dims = (function() {
		var setCookie = function( name, content, expiry ) {
			return document.cookie = name+'='+content+((expiry)?';expires='+(new Date(Math.floor(new Date().getTime()+expiry*1000)).toUTCString()):'')+';path=/';
		};
		var ffid = 1;
		var oh = window.screen.height;
		var ow = window.screen.width;
		var h = ffid === 1 ? oh : (oh > ow) ? oh : ow;
		var w = ffid === 1 ? ow : (oh > ow) ? ow : oh;
		var uh = window.innerHeight || document.documentElement.clientHeight || document.getElementsByTagName('body')[0].clientHeight;
		var uw = window.innerWidth || document.documentElement.clientWidth || document.getElementsByTagName('body')[0].clientWidth;
	
		var setAllCookies = function() {
			setCookie('ezds', encodeURIComponent('ffid='+ffid+',w='+w+',h='+h), (31536e3*7));
			setCookie('ezohw', encodeURIComponent('w='+uw+',h='+uh), (31536e3*7));    
		};
	
		if (window.ezTcfConsent && window.ezTcfConsent.loaded) {
			if (window.ezTcfConsent.understand_audiences) { 
				setAllCookies();
			}
		} else if (typeof getEzConsentData === "function") {
			getEzConsentData().then(function (ezTcfConsent) {
				if (ezTcfConsent && ezTcfConsent.loaded) {
					if (ezTcfConsent.understand_audiences) { 
						setAllCookies();
					}
				} else {
					console.error("cannot get ez consent data");
					setAllCookies();
				}
			});
		} else {
			console.error("getEzConsentData is not a function");
			setAllCookies();
		}
	
	})();
__ez.queue.addFile('/parsonsmaize/chanute.js', '/parsonsmaize/chanute.js?a=a&cb=10&dcb=195-2&shcb=34', true, ['/parsonsmaize/mulvane.js'], true, false, false, false);
__ez.queue.addFile('/porpoiseant/jellyfish.js', '/porpoiseant/jellyfish.js?a=a&cb=16&dcb=195-2&shcb=34', false, [], true, false, false, false);
if(typeof _ezaq!=="undefined"&&typeof __ez=="object"&&typeof __ez.bit=="object"&&typeof __ezDotData=="function"){if("cookieDeprecationLabel"in navigator){navigator.cookieDeprecationLabel.getValue().then((label)=>{__ez.bit.AddAndFire(_ezaq["page_view_id"],[new __ezDotData("chrome_cookie_deprecation_label",label),]);});}}
</script><script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/et.js.download" async=""></script><script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/drake.js.download" async=""></script><script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/jellyfish.js.download" async=""></script><style id="mttstyle">
    #mttContainer {
      left: 0 !important;
      top: 0 !important;
      width: 1000px !important;
      margin: 0px !important;
      margin-left: -500px !important;
      position: fixed !important;
      z-index: 100000200 !important;
      background: none !important;
      pointer-events: none !important;
      display: inline-block !important;
      visibility: visible  !important;
      white-space: pre-line;
    }
    .tippy-box[data-theme~="custom"], .tippy-content *{
      font-size: 18px  !important;
      text-align: center !important;
      overflow-wrap: break-word !important;
      color: #ffffffff !important;
      font-family: 
        -apple-system, BlinkMacSystemFont,
        "Segoe UI", "Roboto", "Oxygen",
        "Ubuntu", "Cantarell", "Fira Sans",
        "Droid Sans", "Helvetica Neue", sans-serif  !important;
      white-space: pre-line;
    }
    .tippy-box[data-theme~="custom"]{
      max-width: 200px  !important;
      backdrop-filter: blur(4px) !important;
      background-color: #000000b8 !important;
      border: 1px solid #ffffff00; 
    }
    [data-tippy-root] {
      display: inline-block !important;
      visibility: visible  !important;
      position: absolute !important;
    }
    .tippy-box[data-theme~='custom'][data-placement^='top'] > .tippy-arrow::before { 
      border-top-color: #000000b8 !important;
    }
    .tippy-box[data-theme~='custom'][data-placement^='bottom'] > .tippy-arrow::before {
      border-bottom-color: #000000b8 !important;
    }
    .tippy-box[data-theme~='custom'][data-placement^='left'] > .tippy-arrow::before {
      border-left-color: #000000b8 !important;
    }
    .tippy-box[data-theme~='custom'][data-placement^='right'] > .tippy-arrow::before {
      border-right-color: #000000b8 !important;
    }
    .mtt-highlight{
      background-color: #21dc6d40  !important;
      position: absolute !important;   
      z-index: 100000100 !important;
      pointer-events: none !important;
      display: inline !important;
      border-radius: 3px !important;
    }
    .mtt-image{
      width: 180px  !important;
      border-radius: 3px !important;
    }
    .ocr_text_div{
      position: absolute;
      opacity: 0.5;
      color: transparent !important;
      border: 2px solid CornflowerBlue;
      background: none !important;
      border-radius: 3px !important;
    }</style><style id="mttstyleSubtitle">
    #ytp-caption-window-container .ytp-caption-segment {
      cursor: text !important;
      user-select: text !important;
      font-family: 
      -apple-system, BlinkMacSystemFont,
      "Segoe UI", "Roboto", "Oxygen",
      "Ubuntu", "Cantarell", "Fira Sans",
      "Droid Sans", "Helvetica Neue", sans-serif  !important;
    }
    .caption-visual-line{
      display: flex  !important;
      align-items: stretch  !important;
    }
    .captions-text .caption-visual-line:first-of-type:after {
      content: '⣿⣿';
      background-color: #000000b8;
      display: inline-block;
      vertical-align: top;
      opacity:0;
      transition: opacity 0.7s ease-in-out;
    }
    .captions-text:hover .caption-visual-line:first-of-type:after {
      opacity:1;
    }
    .ytp-pause-overlay {
      display: none !important;
    }
    .ytp-expand-pause-overlay .caption-window {
      display: block !important;
    }
  </style><script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/mulvane.js.download" async=""></script><script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/olathe.js.download" async=""></script><script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/wichita.js.download" async=""></script><script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/raleigh.js.download" async=""></script><script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/vista.js.download" async=""></script><script type="text/javascript">var ezStaticAnchor = function(anchorXPath, htmlStr, isRequired) {
	var ezRange = document.createRange();
	var ezAnchor = document.evaluate(anchorXPath, document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
	if (typeof ezAnchor !== 'undefined' && ezAnchor !== null) {
		ezRange.selectNode(ezAnchor);
		var fragment = ezRange.createContextualFragment(htmlStr);
		if(isRequired===true) {
			ezAnchor.appendChild(fragment);
		} else {
			ezAnchor.parentNode.insertBefore(fragment, ezAnchor.nextSibling);
		}
	} else {
		var errMsg = 'cannot find anchor for ad position' + anchorXPath + ';';
		console.error(errMsg);
		window.ezstaticerrors = (window.ezstaticerrors || '') + errMsg;
	}
};
try {__ez.queue.addFile('banger.js', '/porpoiseant/banger.js?cb=195-2&bv=380&PageSpeed=off', true, ['ezaqReady'], true, false, false, true);
var _ezim_d = {};
var ezS = document.createElement("script");ezS.src="/detroitchicago/reportads.js?gcb=195-2&cb=5";document.head.appendChild(ezS);
var ezS = document.createElement("style");ezS.innerHTML=".ezoic-ad{display:inline-block;border:0px;}.ezoic-ad>div>iframe{margin:0px!important;padding:0px!important;width:revert-layer;}.ezoic-ad .ezoic-ad>div{text-align:center}";document.head.appendChild(ezS);
var ezS = document.createElement("style");ezS.innerHTML=".ad-reporter-menu-backdrop{display:none;position:absolute;bottom:20px;right:15px;width:120px;height:100px;flex-direction:row;justify-content:center;align-items:center;background:transparent;box-shadow:#000 0 2px 10px;border-radius:10px;z-index:1002}.ad-reporter-menu{position:absolute;z-index:1003;display:flex;flex-direction:column;width:100%;height:100%;background:#fff;border-radius:5px;align-items:center;justify-content:space-around;font-weight:200;font-size:14px;font-family:sans-serif}.ad-reporter-menu .ad-reporter-menu-item{width:100%;height:100%;cursor:pointer;display:flex;justify-content:center;align-items:center}.ad-reporter-menu .ad-reporter-menu-item:not(:last-child){border-bottom:solid #d3d3d3 1px}";document.head.appendChild(ezS);
var ezS = document.createElement("style");ezS.innerHTML="@keyframes ezIn { 			from { opacity: 0; } 		  }		  .ezoic-ad .ezoic-adl:before {content: '\\00B7\\00B7\\00B7';position: absolute;display: flex!important;align-items: center;justify-content: center;text-align: center;color: #C4C4C4;font-size: 62px;letter-spacing: 2px;z-index: 0;animation: ezIn 1s infinite alternate;left: 50%;top: 50%;transform: translate(-50%, -50%);} .ezoic-ad .ezfound,.ezmob-footer .ezoic-ad .ezoic-ad,.ezoic-ad-adaptive > .ezoic-ad, .ezoic-ad-rl {background:0 0;border-radius:0;border:none}";document.head.appendChild(ezS);
var ezS = document.createElement("style");ezS.innerHTML=".ezoic-floating-bottom { display: none!important; }";document.head.appendChild(ezS);
var ezS = document.createElement("style");ezS.innerHTML=".ez-sidebar-wall {display: none;}";document.head.appendChild(ezS);
var didTimeoutVign=false;setTimeout(function(){function getCookie(cname){var name=cname+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' '){c=c.substring(1);}
if(c.indexOf(name)==0){return c.substring(name.length,c.length);}}
return "";}
var cookieTest=getCookie("ezvignetteviewed");if(cookieTest==""){window.googletag=window.googletag||{};googletag.cmd=googletag.cmd||[];googletag.cmd.push(function(){if(typeof window.ezslot_interstitial!='undefined'&&window.ezslot_interstitial!=null){googletag.display(window.ezslot_interstitial);googletag.pubads().refresh([window.ezslot_interstitial]);if(typeof __ez!=='undefined'&&typeof __ez.pel!=='undefined'){__ez.pel.Add(window.ezslot_interstitial,[(new __ezDotData('fetched',1))]);__ez.pel.Fire();}
didTimeoutVign=true;}});}},1000);if(typeof _ezaq!='undefined'&&typeof _ezaq.ab_test_id!='undefined'&&_ezaq.ab_test_id=='mod34'){document.addEventListener("click",expzscr);}
function expzscr(){if(!didTimeoutVign){return;}
var x=window.open();if(x){x.close();document.removeEventListener("click",expzscr);}}
} catch(e) {window.ezstaticerrors = (window.ezstaticerrors || '') + e.toString();}window.ezFinishedStatic=true;</script><script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/banger.js.download" async=""></script><script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/reportads.js.download"></script><style>.ezoic-ad{display:inline-block;border:0px;}.ezoic-ad>div>iframe{margin:0px!important;padding:0px!important;width:revert-layer;}.ezoic-ad .ezoic-ad>div{text-align:center}</style><style>.ad-reporter-menu-backdrop{display:none;position:absolute;bottom:20px;right:15px;width:120px;height:100px;flex-direction:row;justify-content:center;align-items:center;background:transparent;box-shadow:#000 0 2px 10px;border-radius:10px;z-index:1002}.ad-reporter-menu{position:absolute;z-index:1003;display:flex;flex-direction:column;width:100%;height:100%;background:#fff;border-radius:5px;align-items:center;justify-content:space-around;font-weight:200;font-size:14px;font-family:sans-serif}.ad-reporter-menu .ad-reporter-menu-item{width:100%;height:100%;cursor:pointer;display:flex;justify-content:center;align-items:center}.ad-reporter-menu .ad-reporter-menu-item:not(:last-child){border-bottom:solid #d3d3d3 1px}</style><style>@keyframes ezIn { 			from { opacity: 0; } 		  }		  .ezoic-ad .ezoic-adl:before {content: '\00B7\00B7\00B7';position: absolute;display: flex!important;align-items: center;justify-content: center;text-align: center;color: #C4C4C4;font-size: 62px;letter-spacing: 2px;z-index: 0;animation: ezIn 1s infinite alternate;left: 50%;top: 50%;transform: translate(-50%, -50%);} .ezoic-ad .ezfound,.ezmob-footer .ezoic-ad .ezoic-ad,.ezoic-ad-adaptive > .ezoic-ad, .ezoic-ad-rl {background:0 0;border-radius:0;border:none}</style><style>.ezoic-floating-bottom { display: none!important; }</style><style>.ez-sidebar-wall {display: none;}</style><script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/vitals.js.download" async=""></script><script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/nmash.js.download"></script><script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/audins.js.download" async="" type="text/javascript"></script></head>
<body style="" class=""><style>:root{--dialogAccentColor:#0073aa;--dialogBackgroundColor:#fff;--dialogTextColor:#000}@media only screen and (width<=600px){#ez-CCPA.CCPA-bottom-sticky{width:80%!important}}.CCPA-middle-sticky{border:6px solid var(--dialogAccentColor);z-index:1000;border-radius:.8rem;max-width:90%;top:50%;left:50%;transform:translate(-50%,-50%);position:fixed!important}.CCPA-bottom-absolute{border:6px solid var(--dialogAccentColor);border-radius:.8rem;width:100%;position:absolute;z-index:300!important;margin-top:100px!important}#ez-CCPA{z-index:2147483647;background-color:var(--dialogBackgroundColor);color:var(--dialogTextColor);text-align:center;padding:3px;font-size:10px;font-family:gill sans,gill sans mt,Calibri,trebuchet ms,sans-serif!important}#ez-CCPA .button-primary{background-color:var(--dialogAccentColor)!important;border-color:var(--dialogAccentColor)!important}@media (width>=400px){#ez-CCPA .container{width:85%;padding:0}}#ez-CCPA.container{box-sizing:border-box;clear:both;width:100%;max-width:960px;margin:0 auto;padding:0 20px;position:relative}#ez-CCPA .column,#ez-CCPA .columns{float:left;box-sizing:border-box;width:100%}@media (width>=550px){#ez-CCPA .container{width:80%}#ez-CCPA .column,#ez-CCPA .columns{margin-left:4%}#ez-CCPA .column:first-child,#ez-CCPA .columns:first-child{margin-left:0}#ez-CCPA .one.column,#ez-CCPA .one.columns{width:4.66667%}#ez-CCPA .two.columns{width:13.3333%}#ez-CCPA .three.columns{width:22%}#ez-CCPA .four.columns{width:30.6667%}#ez-CCPA .five.columns{width:39.3333%}#ez-CCPA .six.columns{width:48%}#ez-CCPA .seven.columns{width:56.6667%}#ez-CCPA .eight.columns{width:65.3333%}#ez-CCPA .nine.columns{width:74%}#ez-CCPA .ten.columns{width:82.6667%}#ez-CCPA .eleven.columns{width:91.3333%}#ez-CCPA .twelve.columns{width:100%;margin-left:0}#ez-CCPA .one-third.column{width:30.6667%}#ez-CCPA .two-thirds.column{width:65.3333%}#ez-CCPA .one-half.column{width:48%}#ez-CCPA .offset-by-one.column,#ez-CCPA .offset-by-one.columns{margin-left:8.66667%}#ez-CCPA .offset-by-two.column,#ez-CCPA .offset-by-two.columns{margin-left:17.3333%}#ez-CCPA .offset-by-three.column,#ez-CCPA .offset-by-three.columns{margin-left:26%}#ez-CCPA .offset-by-four.column,#ez-CCPA .offset-by-four.columns{margin-left:34.6667%}#ez-CCPA .offset-by-five.column,#ez-CCPA .offset-by-five.columns{margin-left:43.3333%}#ez-CCPA .off set-by-six.column,#ez-CCPA .offset-by-six.columns{margin-left:52%}#ez-CCPA .offset-by-seven.column,#ez-CCPA .offset-by-seven.columns{margin-left:60.6667%}#ez-CCPA .offset-by-eight.column,#ez-CCPA .offset-by-eight.columns{margin-left:69.3333%}#ez-CCPA .offset-by-nine.column,#ez-CCPA .offset-by-nine.columns{margin-left:78%}#ez-CCPA .offset-by-ten.column,#ez-CCPA .offset-by-ten.columns{margin-left:86.6667%}#ez-CCPA .offset-by-eleven.column,#ez-CCPA .offset-by-eleven.columns{margin-left:95.3333%}#ez-CCPA .offset-by-one-third.column,#ez-CCPA .offset-by-one-third.columns{margin-left:34.6667%}#ez-CCPA .offset-by-two-thirds.column,#ez-CCPA .offset-by-two-thirds.columns{margin-left:69.3333%}#ez-CCPA .offset-by-one-half.column,#ez-CCPA .offset-by-one-half.columns{margin-left:52%}}#ez-CCPA{color:#222;font-family:Raleway,HelveticaNeue,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:1.1em;font-weight:400;line-height:1.6}#ez-CCPA h1,#ez-CCPA h2,#ez-CCPA h3,#ez-CCPA h4,#ez-CCPA h5,#ez-CCPA h6{margin-top:0;margin-bottom:2rem;font-weight:300}#ez-CCPA h1{letter-spacing:-.1rem;font-size:4rem;line-height:1.2}#ez-CCPA h2{letter-spacing:-.1rem;font-size:3.2rem;line-height:1.25}#ez-CCPA h3{letter-spacing:-.1rem;font-size:2.8rem;line-height:1.3}#ez-CCPA h4{letter-spacing:-.08rem;font-size:2.4rem;line-height:1.35}#ez-CCPA h5{letter-spacing:-.05rem;font-size:1.8rem;line-height:1.5}#ez-CCPA h6{letter-spacing:0;font-size:1.5rem;line-height:1.6}@media (width>=550px){#ez-CCPA h1{font-size:4rem}#ez-CCPA h2{font-size:3.2rem}#ez-CCPA h3{font-size:2.6rem}#ez-CCPA h4{font-size:1rem}#ez-CCPA h5{font-size:.8rem}#ez-CCPA h6{font-size:.6rem}}#ez-CCPA p{margin-top:0}#ez-CCPA a{color:#1eaedb}#ez-CCPA a:hover{color:#0fa0ce}#ez-CCPA .button,#ez-CCPA button,#ez-CCPA input[type=submit],#ez-CCPA input[type=reset],#ez-CCPA input[type=button]{color:#555;text-align:center;letter-spacing:.1rem;text-transform:uppercase;white-space:nowrap;cursor:pointer;box-sizing:border-box;white-space:nowrap;cursor:pointer;background-color:#0000;border:1px solid #bbb;border-radius:4px;height:38px;padding:0 30px;font-size:11px;font-weight:600;line-height:38px;text-decoration:none;display:inline-block}#ez-CCPA .button:hover,#ez-CCPA button:hover,#ez-CCPA input[type=submit]:hover,#ez-CCPA input[type=reset]:hover,#ez-CCPA input[type=button]:hover,#ez-CCPA .button:focus,#ez-CCPA button:focus,#ez-CCPA input[type=submit]:focus,#ez-CCPA input[type=reset]:focus,#ez-CCPA input[type=button]:focus{color:#333;border-color:#888;outline:0}#ez-CCPA .button.button-primary,#ez-CCPA button.button-primary,#ez-CCPA input[type=submit].button-primary,#ez-CCPA input[type=reset].button-primary,#ez-CCPA input[type=button].button-primary{color:#fff;background-color:#33c3f0;border-color:#33c3f0}#ez-CCPA .button.button-primary:hover,#ez-CCPA button.button-primary:hover,#ez-CCPA input[type=submit].button-primary:hover,#ez-CCPA input[type=reset].button-primary:hover,#ez-CCPA input[type=button].button-primary:hover,#ez-CCPA .button.button-primary:focus,#ez-CCPA button.button-primary:focus,#ez-CCPA input[type=submit].button-primary:focus,#ez-CCPA input[type=reset].button-primary:focus,#ez-CCPA input[type=button].button-primary:focus{color:#fff;background-color:#1eaedb;border-color:#1eaedb}#ez-CCPA input[type=email],#ez-CCPA input[type=number],#ez-CCPA input[type=search],#ez-CCPA input[type=text],#ez-CCPA input[type=tel],#ez-CCPA input[type=url],#ez-CCPA input[type=password],#ez-CCPA textarea,#ez-CCPA select{box-shadow:none;box-sizing:border-box;background-color:#fff;border:1px solid #d1d1d1;border-radius:4px;height:38px;padding:6px 10px}#ez-CCPA input[type=email],#ez-CCPA input[type=number],#ez-CCPA input[type=search],#ez-CCPA input[type=text],#ez-CCPA input[type=tel],#ez-CCPA input[type=url],#ez-CCPA input[type=password],#ez-CCPA textarea{-webkit-appearance:none;-moz-appearance:none;appearance:none}#ez-CCPA textarea{min-height:65px;padding-top:6px;padding-bottom:6px}#ez-CCPA input[type=email]:focus,#ez-CCPA input[type=number]:focus,#ez-CCPA input[type=search]:focus,#ez-CCPA input[type=text]:focus,#ez-CCPA input[type=tel]:focus,#ez-CCPA input[type=url]:focus,#ez-CCPA input[type=password]:focus,#ez-CCPA textarea:focus,#ez-CCPA select:focus{border:1px solid #33c3f0;outline:0}#ez-CCPA label,#ez-CCPA legend{margin-bottom:.5rem;font-weight:600;display:block}#ez-CCPA fieldset{border-width:0;padding:0}#ez-CCPA input[type=checkbox],#ez-CCPA input[type=radio]{display:inline}#ez-CCPA label>.label-body{margin-left:.5rem;font-weight:400;display:inline-block}#ez-CCPA ul{list-style:circle inside}#ez-CCPA ol{list-style:decimal inside}#ez-CCPA ol,#ez-CCPA ul{margin-top:0;padding-left:0}#ez-CCPA ul #ez-CCPA ul,#ez-CCPA ul #ez-CCPA ol,#ez-CCPA ol #ez-CCPA ol,#ez-CCPA ol #ez-CCPA ul{margin:1.5rem 0 1.5rem 3rem;font-size:90%}#ez-CCPA li{margin-bottom:1rem}#ez-CCPA code{white-space:nowrap;background:#f1f1f1;border:1px solid #e1e1e1;border-radius:4px;margin:0 .2rem;padding:.2rem .5rem;font-size:90%}#ez-CCPA pre>code{white-space:pre;padding:1rem 1.5rem;display:block}#ez-CCPA th,#ez-CCPA td{text-align:left;border-bottom:1px solid #e1e1e1;padding:12px 15px}#ez-CCPA th:first-child,#ez-CCPA td:first-child{padding-left:0}#ez-CCPA th:last-child,#ez-CCPA td:last-child{padding-right:0}#ez-CCPA button,#ez-CCPA .button{margin-bottom:1rem}#ez-CCPA input,#ez-CCPA textarea,#ez-CCPA select,#ez-CCPA fieldset{margin-bottom:1.5rem}#ez-CCPA pre,#ez-CCPA blockquote,#ez-CCPA dl,#ez-CCPA figure,#ez-CCPA table,#ez-CCPA p,#ez-CCPA ul,#ez-CCPA ol,#ez-CCPA form{margin-bottom:2.5rem}#ez-CCPA .u-full-width{box-sizing:border-box;width:100%}#ez-CCPA .u-max-full-width{box-sizing:border-box;max-width:100%}#ez-CCPA .u-pull-right{float:right}#ez-CCPA .u-pull-left{float:left}#ez-CCPA hr{border-width:1px 0 0;border-top-style:solid;border-top-color:#e1e1e1;margin-top:3rem;margin-bottom:3.5rem}#ez-CCPA .container:after,#ez-CCPA .row:after,#ez-CCPA .u-cf{content:"";clear:both;display:table}#ez-CCPA .space-between{justify-content:space-between;display:flex}</style>
    <!-- Navigation -->

<nav class="navbar navbar-expand-lg navbar-light fixed-top is-fixed" id="mainNav" style="">
  <div class="container-fluid">
    <a class="navbar-brand" href="https://thepythoncode.com/"><img style="width: 40px;height:40px;" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/python_logo.svg" alt="Python Code">&nbsp;&nbsp;The Python Code</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item"><a class="nav-link" href="https://thepythoncode.com/">Home</a></li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="https://thepythoncode.com/articles?o=date">Tutorials</a>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
            <li><a class="dropdown-item" href="https://thepythoncode.com/articles?o=date">All Tutorials - Newest</a></li>
            <li><a class="dropdown-item" href="https://thepythoncode.com/articles?o=views">All Tutorials - Popular</a></li>
            <li><hr class="dropdown-divider"></li>
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/topic/ethical-hacking">Ethical Hacking</a></li>
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/topic/machine-learning">Machine Learning</a></li>
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/topic/general-python-topics">General Python Tutorials</a></li>
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/topic/web-scraping">Web Scraping</a></li>
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/topic/finance">Finance</a></li>
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/topic/computer-vision">Computer Vision</a></li>
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/topic/python-standard-library">Python Standard Library</a></li>
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/topic/using-apis-in-python">Application Programming Interfaces</a></li>
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/topic/using-databases-in-python">Database</a></li>
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/topic/game-development">Game Development</a></li>
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/topic/web-programming">Web Programming</a></li>
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/topic/digital-forensics-with-python">Digital Forensics</a></li>
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/topic/nlp">Natural Language Processing</a></li>
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/topic/healthcare">Healthcare</a></li>
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/topic/handling-pdf-files">PDF File Handling</a></li>
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/topic/python-for-multimedia">Python for Multimedia</a></li>
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/topic/gui-programming">GUI Programming</a></li>
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/topic/cryptography-with-python">Cryptography</a></li>
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/topic/scapy">Packet Manipulation Using Scapy</a></li>
            
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="https://thepythoncode.com/article/real-time-vehicle-tracking-and-counting-with-yolov8-opencv#">Tools</a>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
            <li><a class="dropdown-item" href="https://codingfleet.com/code-generator/python/"><i class="fas fa-code" style="width: 20px; height: 20px;"></i> Code Generator</a></li>
            <li><a class="dropdown-item" href="https://codingfleet.com/code-assistant/python/"><i class="fas fa-robot" style="width: 20px; height: 20px;"></i> Code Assistant</a></li>
            <li><a class="dropdown-item" href="https://codingfleet.com/code-explainer/python/"><i class="fas fa-lightbulb" style="width: 20px; height: 20px;"></i> Code Explainer</a></li>
            <li><a class="dropdown-item" href="https://codingfleet.com/code-enhancer/python/"><i class="fas fa-wand-magic-sparkles" style="width: 20px; height: 20px;"></i> Code Enhancer</a></li>
            <li><a class="dropdown-item" href="https://codingfleet.com/comment-generator/python/"><i class="fas fa-file-alt" style="width: 20px; height: 20px;"></i> Comment Generator</a></li>
            <li><a class="dropdown-item" href="https://codingfleet.com/unit-test-generator/python/"><i class="fas fa-flask" style="width: 20px; height: 20px;"></i> Unit Test Generator</a></li>
            <li><a class="dropdown-item" href="https://codingfleet.com/code-converter/python/"><i class="fas fa-exchange-alt" style="width: 20px; height: 20px;"></i> Code Converter</a></li>
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="https://thepythoncode.lemonsqueezy.com/">EBooks</a>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
            
            
            
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/ethical-hacking-with-python-ebook">Ethical Hacking with Python EBook</a></li>
            
            
            
            
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/practical-python-pdf-processing-ebook">Practical Python PDF Processing EBook</a></li>
            
            
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/cryptography-with-python-ebook">Cryptography with Python EBook</a></li>
            
            
            
            <li><a class="dropdown-item" href="https://thepythoncode.com/build-an-automatic-number-plate-recognition-system-with-opencv-and-yolo-ebook">Mastering YOLO: Build an Automatic Number Plate Recognition System</a></li>
            
            
          </ul>
        </li>
        <li class="nav-item"><a class="nav-link" href="https://thepythoncode.com/contact">Contact Us</a></li>
      </ul>
    </div>
  </div>
</nav>
  
  <header class="masthead" style="background-image: url(&#39;/media/articles/trajectories-drawn-on-the-frame.webp&#39;)">
    <div class="overlay"></div>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto" style="z-index: 1;">
            <div class="site-heading">
            <h1>Real-Time Vehicle Detection, Tracking and Counting in Python</h1>
            <span class="sub-heading">Learn how to perform vehicle detection, tracking and counting with YOLOv8 and DeepSORT using OpenCV library in Python.</span>
            </div>
        </div>
      </div>
    </div>
  </header>
  
    

    <div class="container-fluid px-md-5">
        <div class="row"><span id="ezoic-pub-ad-placeholder-106" class="ezoic-adpicker-ad"></span><span data-ez-ph-id="106"></span>
            <div class="col-12 col-md-10 col-xl-8 py-md-3 pl-md-6">
            
<span class="text-secondary" style="font-size:13px; margin-top:-3px;">
    <i class="fas fa-user-tie">&nbsp;
    </i>
    <span class="text-capitalize">
        
            
                
                    <a href="https://thepythoncode.com/author/yacine-rouizi" rel="author">
                        Yacine Rouizi 
                    </a> ·
                
            
        
            </span>
    <i aria-hidden="true" class="fa fa-clock">
    </i>
    18 min read
    · Updated 
    <span class="text-capitalize"> aug 2023 </span>
    <span id="n-views">· <i class="fas fa-eye"></i> 6.6K</span>
    
    · <a href="https://thepythoncode.com/topic/machine-learning" class="text-info" style="font-size:13px; margin-top:-3px;">Machine Learning</a>
    
    · <a href="https://thepythoncode.com/topic/computer-vision" class="text-info" style="font-size:13px; margin-top:-3px;">Computer Vision</a>
    
    
</span>
<br><br>
<p style="font-family: Inter; font-size: 12pt;"><i>Want to code faster? Our <a class="code-generator-text" target="_blank" href="https://codingfleet.com/code-generator/python/">Python Code Generator</a> lets you create Python scripts with just a few clicks. Try it now!</i></p>

<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">By combining the power of <a title="YOLOv8 - ultralytics" href="https://github.com/ultralytics/ultralytics" target="_blank" rel="noopener">YOLOv8</a> and DeepSORT, in this tutorial, I will show you how to build a real-time vehicle tracking and counting system with Python and OpenCV.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">YOLOv8 serves as an exceptional starting point for our journey. With YOLOv8 as our object detection backbone, we will be equipped to detect vehicles precisely, making it the perfect foundation for building a real-time vehicle tracking system.</span></span></p><span id="ezoic-pub-ad-placeholder-144" class="ezoic-adpicker-ad"></span><span data-ez-ph-id="144"></span>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">However, detecting vehicles in individual frames is only the beginning. The real challenge lies in seamlessly associating vehicles across consecutive frames to maintain their identity throughout a video sequence. This is where DeepSORT comes into play, bringing advanced deep learning techniques to multi-object tracking.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">By integrating DeepSORT with YOLOv8, we can build a robust vehicle tracking system that can accurately track and count vehicles in real time.</span></span><span id="ezoic-pub-ad-placeholder-107" class="ezoic-adpicker-ad"></span><span data-ez-ph-id="107"></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">The ability to accurately detect, track, and count vehicles in dynamic environments can lead to more efficient traffic flow, enhanced safety measures, and informed decision-making for transportation authorities.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">By the end of this journey, you will have a working prototype of a real-time vehicle tracking and counting system that you can use as a starting point for your own projects.</span></span></p>
<h2><span style="font-family: helvetica, arial, sans-serif; font-size: 18pt;">Table of Contents</span></h2>
<ul>
<li><a href="https://thepythoncode.com/article/real-time-vehicle-tracking-and-counting-with-yolov8-opencv#installing-the-python-packages"><span style="font-family: helvetica, arial, sans-serif; font-size: 12pt;">Installing the Python Packages</span></a></li>
<li><a href="https://thepythoncode.com/article/real-time-vehicle-tracking-and-counting-with-yolov8-opencv#project-structure"><span style="font-family: helvetica, arial, sans-serif; font-size: 12pt;"><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Project Structure</span></span></span></a></li>
<li><span style="font-family: helvetica, arial, sans-serif; font-size: 12pt;"><a href="https://thepythoncode.com/article/real-time-vehicle-tracking-and-counting-with-yolov8-opencv#real-time-object-detection-with-yolov8-and-opencv">Real-Time Object Detection with YOLOv8 and OpenCV</a></span></li>
<li><a href="https://thepythoncode.com/article/real-time-vehicle-tracking-and-counting-with-yolov8-opencv#real-time-object-tracking-with-deepsort-and-opencv"><span style="font-family: helvetica, arial, sans-serif; font-size: 12pt;"><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Real-Time Object Tracking with DeepSORT and OpenCV</span></span></span></a></li>
<li><a href="https://thepythoncode.com/article/real-time-vehicle-tracking-and-counting-with-yolov8-opencv#vehicle-counting-with-yolov8-and-deepsort"><span style="font-family: helvetica, arial, sans-serif; font-size: 12pt;"><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Vehicle Counting with YOLOv8 and DeepSORT</span></span></span></a></li>
<li><a href="https://thepythoncode.com/article/real-time-vehicle-tracking-and-counting-with-yolov8-opencv#summary"><span style="font-family: helvetica, arial, sans-serif; font-size: 12pt;"><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Summary</span></span></span></a></li>
</ul>
<h2><span style="font-size: 18pt;"><a id="installing-the-python-packages"></a><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 24px;">Installing the Python Packages</span></span></span></h2>
<p><span style="font-size: 12pt;"><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">In order to use YOLOv8 and DeepSORT, we need to install the <a title="Ultralytics" href="https://github.com/ultralytics/ultralytics" target="_blank" rel="noopener">Ultralytics</a> and DeepSORT Python packages.</span></span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">There are some issues with <a href="https://github.com/nwojke/deep_sort" target="_blank" rel="noopener">the original DeepSORT implementation</a> at the time of writing this, so I <a href="https://github.com/python-dontrepeatyourself/deep_sort" target="_blank" rel="noopener">forked the repository</a> and made some adjustments to make it work with the latest version of TensorFlow and can get the class names of the detected objects.</span></span><span id="ezoic-pub-ad-placeholder-108" class="ezoic-adpicker-ad"></span><span data-ez-ph-id="108"></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">To install the Ultralytics and my forked version of the DeepSORT packages, run the following commands in your terminal (make sure you are inside the project directory):</span></span></p>
<div class="code-toolbar"><pre class=" language-python"><code class=" language-python">$ pip install ultralytics
$ git clone git@github<span class="token punctuation">.</span>com<span class="token punctuation">:</span>python<span class="token operator">-</span>dontrepeatyourself<span class="token operator">/</span>deep_sort<span class="token punctuation">.</span>git</code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
<p><span style="font-family: helvetica, arial, sans-serif; font-size: 12pt;">Let's now review our project structure for this tutorial.</span></p>
<h2><span style="font-family: helvetica, arial, sans-serif; font-size: 18pt;"><a id="project-structure"></a>Project Structure</span></h2>
<p><span style="font-family: helvetica, arial, sans-serif; font-size: 12pt;">Here is how I structured this project:</span></p>
<div class="code-toolbar"><pre class=" language-python"><code class=" language-python">$ tree <span class="token operator">-</span><span class="token operator">-</span>filelimit <span class="token number">8</span>
<span class="token punctuation">.</span>
├── <span class="token number">1.</span>mp4
├── config
│   ├── coco<span class="token punctuation">.</span>names
│   └── mars<span class="token operator">-</span>small128<span class="token punctuation">.</span>pb
├── deep_sort  <span class="token punctuation">[</span><span class="token number">9</span> entries exceeds filelimit<span class="token punctuation">,</span> <span class="token keyword">not</span> opening <span class="token builtin">dir</span><span class="token punctuation">]</span>
├── helper<span class="token punctuation">.</span>py
├── object_detection_tracking<span class="token punctuation">.</span>py
├── output<span class="token punctuation">.</span>mp4
├── ultralytics  <span class="token punctuation">[</span><span class="token number">16</span> entries exceeds filelimit<span class="token punctuation">,</span> <span class="token keyword">not</span> opening <span class="token builtin">dir</span><span class="token punctuation">]</span>
└── yolov8n<span class="token punctuation">.</span>pt</code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
<p><span style="font-family: helvetica, arial, sans-serif; font-size: 12pt;">Here is a brief description of the files and folders:</span></p>
<ul>
<li><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;"><code>1.mp4</code>: The input video file.</span></span></li>
<li><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;"><code>config</code>: The configuration folder that contains the COCO class names and the DeepSORT model.</span></span></li>
<li><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;"><code>deep_sort</code>: The DeepSORT package (my forked version).</span></span></li>
<li><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;"><code>helper.py</code>: A helper Python file that contains a function to create a video writer object.</span></span></li>
<li><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;"><code>object_detection_tracking.py</code>: The main Python file that contains the code for object detection and tracking with YOLOv8 and DeepSORT.</span></span></li>
<li><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;"><code>output.mp4</code>: The output video file when running the <code>object_detection_tracking.py</code> file.</span></span></li>
<li><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;"><code>ultralytics</code>: The Ultralytics package.</span></span></li>
<li><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;"><code>yolov8n.pt</code>: The YOLOv8 weights.</span></span></li>
</ul>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Things can get a little bit confusing when it comes to object detection and tracking. So to make things easier, we will first see how to detect vehicles in a video using YOLOv8 and then we will see how we can integrate the DeepSORT tracker with our YOLOv8 object detector to track those vehicles and count them.</span></span></p><!-- End Ezoic - gen_under_page_title - under_page_title --><span id="ezoic-pub-ad-placeholder-901" data-method="placement-service"></span><span data-ez-ph-id="901"></span><!-- Ezoic - gen_under_page_title - under_page_title -->
<p><span id="ezoic-pub-ad-placeholder-109" class="ezoic-adpicker-ad"></span><span data-ez-ph-id="109"></span><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Let's start with object detection.</span></span></p>
<h2><span style="font-size: 18pt;"><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 24px;"><a id="real-time-object-detection-with-yolov8-and-opencv"></a>Real-Time Object Detection with YOLOv8 and OpenCV</span></span></span></h2>
<p><span style="font-size: 12pt;"><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Creating an object detector with YOLOv8 is very easy. All we need to do is import the YOLOv8 class from the Ultralytics package and apply it to an image or a video.</span></span></span></p><span id="ezoic-pub-video-placeholder-3" class="ezoic-videopicker-video"></span>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Let's first create a new Python file called <code>object_detection_tracking.py</code> and import the necessary packages:</span></span></p>
<div class="code-toolbar"><pre class=" language-python"><code class=" language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> datetime
<span class="token keyword">import</span> cv2
<span class="token keyword">from</span> ultralytics <span class="token keyword">import</span> YOLO

<span class="token keyword">from</span> helper <span class="token keyword">import</span> create_video_writer

conf_threshold <span class="token operator">=</span> <span class="token number">0.5</span>

<span class="token comment"># Initialize the video capture and the video writer objects</span>
video_cap <span class="token operator">=</span> cv2<span class="token punctuation">.</span>VideoCapture<span class="token punctuation">(</span><span class="token string">"1.mp4"</span><span class="token punctuation">)</span>
writer <span class="token operator">=</span> create_video_writer<span class="token punctuation">(</span>video_cap<span class="token punctuation">,</span> <span class="token string">"output.mp4"</span><span class="token punctuation">)</span>
<span class="token comment"># Initialize the YOLOv8 model using the default weights</span>
model <span class="token operator">=</span> YOLO<span class="token punctuation">(</span><span class="token string">"yolov8s.pt"</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">We will use the <code>conf_threshold</code> variable to set the confidence threshold for object detection. This means that we will only detect objects with a confidence score greater than the confidence threshold.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">The <code>create_video_writer()</code> function is a helper function that we will use to create a video writer object. We will use this object to write the output video.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">The <code>model</code> variable is a YOLOv8 object that we will use to detect objects in the video.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Here we are using the default YOLOv8 weights that are provided by Ultralytics (<code>yolov8n.pt</code>), which are trained on <a title="the COCO dataset" href="https://cocodataset.org/" target="_blank" rel="noopener">the COCO dataset</a>. The weights will be downloaded automatically when you first run the code.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">You can also use your own custom weights, but you will need to train the model on your own dataset first (which is outside the scope of this tutorial).</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Let's now loop over the frames of the video and detect objects in each frame:</span></span></p>
<div class="code-toolbar"><pre class=" language-python"><code class=" language-python"><span class="token comment"># loop over the frames</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token comment"># starter time to computer the fps</span>
    start <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ret<span class="token punctuation">,</span> frame <span class="token operator">=</span> video_cap<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># if there is no frame, we have reached the end of the video</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> ret<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"End of the video file..."</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>
    <span class="token comment">############################################################</span>
    <span class="token comment">### Detect the objects in the frame using the YOLO model ###</span>
    <span class="token comment">############################################################</span>
    <span class="token comment"># run the YOLO model on the frame</span>
    results <span class="token operator">=</span> model<span class="token punctuation">(</span>frame<span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Inside the loop, we first read the next frame from the video capture object.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">The <code>ret</code> variable is a boolean that indicates whether the frame was successfully read. If the frame was successfully read, the <code>frame</code> variable will contain the frame. Otherwise, the <code>frame</code> variable will be <code>None</code>.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">So if the <code>ret</code> variable is <code>False</code>, we have reached the end of the video and we break out of the loop.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Then we run the YOLOv8 model on the frame. This will return a <code>ultralytics.yolo.engine.results.Results</code> object with the following attributes:</span></span></p>
<div class="code-toolbar"><pre class=" language-python"><code class=" language-python">boxes<span class="token punctuation">:</span> ultralytics<span class="token punctuation">.</span>yolo<span class="token punctuation">.</span>engine<span class="token punctuation">.</span>results<span class="token punctuation">.</span>Boxes <span class="token builtin">object</span>
keypoints<span class="token punctuation">:</span> <span class="token boolean">None</span>
keys<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'boxes'</span><span class="token punctuation">]</span>
masks<span class="token punctuation">:</span> <span class="token boolean">None</span>
names<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'person'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">'bicycle'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">'car'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">'motorcycle'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">:</span> <span class="token string">'airplane'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">:</span> <span class="token string">'bus'</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">:</span> <span class="token string">'train'</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">:</span> <span class="token string">'truck'</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">:</span> <span class="token string">'boat'</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">:</span> <span class="token string">'traffic light'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">:</span> <span class="token string">'fire hydrant'</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">:</span> <span class="token string">'stop sign'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">:</span> <span class="token string">'parking meter'</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">:</span> <span class="token string">'bench'</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">:</span> <span class="token string">'bird'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">:</span> <span class="token string">'cat'</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">:</span> <span class="token string">'dog'</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">:</span> <span class="token string">'horse'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">:</span> <span class="token string">'sheep'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">:</span> <span class="token string">'cow'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">:</span> <span class="token string">'elephant'</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">:</span> <span class="token string">'bear'</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">:</span> <span class="token string">'zebra'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">:</span> <span class="token string">'giraffe'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">:</span> <span class="token string">'backpack'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">:</span> <span class="token string">'umbrella'</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">:</span> <span class="token string">'handbag'</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">:</span> <span class="token string">'tie'</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">:</span> <span class="token string">'suitcase'</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">:</span> <span class="token string">'frisbee'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">:</span> <span class="token string">'skis'</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">:</span> <span class="token string">'snowboard'</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">:</span> <span class="token string">'sports ball'</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">:</span> <span class="token string">'kite'</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">:</span> <span class="token string">'baseball bat'</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">:</span> <span class="token string">'baseball glove'</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">:</span> <span class="token string">'skateboard'</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">:</span> <span class="token string">'surfboard'</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">:</span> <span class="token string">'tennis racket'</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">:</span> <span class="token string">'bottle'</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">:</span> <span class="token string">'wine glass'</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">:</span> <span class="token string">'cup'</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">:</span> <span class="token string">'fork'</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">:</span> <span class="token string">'knife'</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">:</span> <span class="token string">'spoon'</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">:</span> <span class="token string">'bowl'</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">:</span> <span class="token string">'banana'</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">:</span> <span class="token string">'apple'</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">:</span> <span class="token string">'sandwich'</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">:</span> <span class="token string">'orange'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">:</span> <span class="token string">'broccoli'</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">:</span> <span class="token string">'carrot'</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">:</span> <span class="token string">'hot dog'</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">:</span> <span class="token string">'pizza'</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">:</span> <span class="token string">'donut'</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">:</span> <span class="token string">'cake'</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">:</span> <span class="token string">'chair'</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">:</span> <span class="token string">'couch'</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">:</span> <span class="token string">'potted plant'</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">:</span> <span class="token string">'bed'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">:</span> <span class="token string">'dining table'</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">:</span> <span class="token string">'toilet'</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">:</span> <span class="token string">'tv'</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">:</span> <span class="token string">'laptop'</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">:</span> <span class="token string">'mouse'</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">:</span> <span class="token string">'remote'</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">:</span> <span class="token string">'keyboard'</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">:</span> <span class="token string">'cell phone'</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">:</span> <span class="token string">'microwave'</span><span class="token punctuation">,</span> <span class="token number">69</span><span class="token punctuation">:</span> <span class="token string">'oven'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">:</span> <span class="token string">'toaster'</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">:</span> <span class="token string">'sink'</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">:</span> <span class="token string">'refrigerator'</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">:</span> <span class="token string">'book'</span><span class="token punctuation">,</span> <span class="token number">74</span><span class="token punctuation">:</span> <span class="token string">'clock'</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">:</span> <span class="token string">'vase'</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">:</span> <span class="token string">'scissors'</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">:</span> <span class="token string">'teddy bear'</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">:</span> <span class="token string">'hair drier'</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">:</span> <span class="token string">'toothbrush'</span><span class="token punctuation">}</span>
orig_img<span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">145</span><span class="token punctuation">,</span> <span class="token number">138</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">149</span><span class="token punctuation">,</span> <span class="token number">142</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span><span class="token number">107</span><span class="token punctuation">,</span> <span class="token number">153</span><span class="token punctuation">,</span> <span class="token number">146</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span><span class="token number">132</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">138</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span><span class="token number">132</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">138</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span><span class="token number">125</span><span class="token punctuation">,</span> <span class="token number">143</span><span class="token punctuation">,</span> <span class="token number">131</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

                <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>

                <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">164</span><span class="token punctuation">,</span> <span class="token number">156</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span><span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">158</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span><span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">158</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span><span class="token number">133</span><span class="token punctuation">,</span> <span class="token number">138</span><span class="token punctuation">,</span> <span class="token number">144</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span><span class="token number">133</span><span class="token punctuation">,</span> <span class="token number">138</span><span class="token punctuation">,</span> <span class="token number">144</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span><span class="token number">133</span><span class="token punctuation">,</span> <span class="token number">138</span><span class="token punctuation">,</span> <span class="token number">144</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>uint8<span class="token punctuation">)</span>
orig_shape<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">720</span><span class="token punctuation">,</span> <span class="token number">1280</span><span class="token punctuation">)</span>
path<span class="token punctuation">:</span> <span class="token string">'image0.jpg'</span>
probs<span class="token punctuation">:</span> <span class="token boolean">None</span>
speed<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'preprocess'</span><span class="token punctuation">:</span> <span class="token number">0.5915164947509766</span><span class="token punctuation">,</span> <span class="token string">'inference'</span><span class="token punctuation">:</span> <span class="token number">34.77835655212402</span><span class="token punctuation">,</span> <span class="token string">'postprocess'</span><span class="token punctuation">:</span> <span class="token number">0.5271434783935547</span><span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
<p><span style="font-family: helvetica, arial, sans-serif; font-size: 12pt;">The <code>boxes</code> attribute is a <code>ultralytics.yolo.engine.results.Boxes</code> object that contains the bounding boxes of the detected objects and some other information:</span></p>
<div class="code-toolbar"><pre class=" language-python"><code class=" language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>results<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>boxes<span class="token punctuation">)</span>
<span class="token comment"># output:</span>
boxes<span class="token punctuation">:</span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">7.8548e+02</span><span class="token punctuation">,</span> <span class="token number">5.1154e-01</span><span class="token punctuation">,</span> <span class="token number">1.0214e+03</span><span class="token punctuation">,</span> <span class="token number">6.2262e+02</span><span class="token punctuation">,</span> <span class="token number">9.2543e-01</span><span class="token punctuation">,</span> <span class="token number">0.0000e+00</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">5.0879e+02</span><span class="token punctuation">,</span> <span class="token number">2.5563e+02</span><span class="token punctuation">,</span> <span class="token number">6.3798e+02</span><span class="token punctuation">,</span> <span class="token number">6.2519e+02</span><span class="token punctuation">,</span> <span class="token number">8.5625e-01</span><span class="token punctuation">,</span> <span class="token number">0.0000e+00</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3.0231e+02</span><span class="token punctuation">,</span> <span class="token number">3.6799e+02</span><span class="token punctuation">,</span> <span class="token number">7.0716e+02</span><span class="token punctuation">,</span> <span class="token number">6.3381e+02</span><span class="token punctuation">,</span> <span class="token number">5.6319e-01</span><span class="token punctuation">,</span> <span class="token number">1.3000e+01</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3.0361e+02</span><span class="token punctuation">,</span> <span class="token number">3.6963e+02</span><span class="token punctuation">,</span> <span class="token number">5.5384e+02</span><span class="token punctuation">,</span> <span class="token number">6.3172e+02</span><span class="token punctuation">,</span> <span class="token number">3.0199e-01</span><span class="token punctuation">,</span> <span class="token number">1.3000e+01</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
cls<span class="token punctuation">:</span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
conf<span class="token punctuation">:</span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.9254</span><span class="token punctuation">,</span> <span class="token number">0.8562</span><span class="token punctuation">,</span> <span class="token number">0.5632</span><span class="token punctuation">,</span> <span class="token number">0.3020</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
data<span class="token punctuation">:</span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">7.8548e+02</span><span class="token punctuation">,</span> <span class="token number">5.1154e-01</span><span class="token punctuation">,</span> <span class="token number">1.0214e+03</span><span class="token punctuation">,</span> <span class="token number">6.2262e+02</span><span class="token punctuation">,</span> <span class="token number">9.2543e-01</span><span class="token punctuation">,</span> <span class="token number">0.0000e+00</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">5.0879e+02</span><span class="token punctuation">,</span> <span class="token number">2.5563e+02</span><span class="token punctuation">,</span> <span class="token number">6.3798e+02</span><span class="token punctuation">,</span> <span class="token number">6.2519e+02</span><span class="token punctuation">,</span> <span class="token number">8.5625e-01</span><span class="token punctuation">,</span> <span class="token number">0.0000e+00</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3.0231e+02</span><span class="token punctuation">,</span> <span class="token number">3.6799e+02</span><span class="token punctuation">,</span> <span class="token number">7.0716e+02</span><span class="token punctuation">,</span> <span class="token number">6.3381e+02</span><span class="token punctuation">,</span> <span class="token number">5.6319e-01</span><span class="token punctuation">,</span> <span class="token number">1.3000e+01</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3.0361e+02</span><span class="token punctuation">,</span> <span class="token number">3.6963e+02</span><span class="token punctuation">,</span> <span class="token number">5.5384e+02</span><span class="token punctuation">,</span> <span class="token number">6.3172e+02</span><span class="token punctuation">,</span> <span class="token number">3.0199e-01</span><span class="token punctuation">,</span> <span class="token number">1.3000e+01</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token builtin">id</span><span class="token punctuation">:</span> <span class="token boolean">None</span>
is_track<span class="token punctuation">:</span> <span class="token boolean">False</span>
orig_shape<span class="token punctuation">:</span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token number">720</span><span class="token punctuation">,</span> <span class="token number">1280</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
shape<span class="token punctuation">:</span> torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
xywh<span class="token punctuation">:</span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">903.4377</span><span class="token punctuation">,</span> <span class="token number">311.5681</span><span class="token punctuation">,</span> <span class="token number">235.9163</span><span class="token punctuation">,</span> <span class="token number">622.1130</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token punctuation">[</span><span class="token number">573.3878</span><span class="token punctuation">,</span> <span class="token number">440.4119</span><span class="token punctuation">,</span> <span class="token number">129.1873</span><span class="token punctuation">,</span> <span class="token number">369.5559</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token punctuation">[</span><span class="token number">504.7360</span><span class="token punctuation">,</span> <span class="token number">500.8981</span><span class="token punctuation">,</span> <span class="token number">404.8489</span><span class="token punctuation">,</span> <span class="token number">265.8228</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token punctuation">[</span><span class="token number">428.7267</span><span class="token punctuation">,</span> <span class="token number">500.6769</span><span class="token punctuation">,</span> <span class="token number">250.2260</span><span class="token punctuation">,</span> <span class="token number">262.0896</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
xywhn<span class="token punctuation">:</span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.7058</span><span class="token punctuation">,</span> <span class="token number">0.4327</span><span class="token punctuation">,</span> <span class="token number">0.1843</span><span class="token punctuation">,</span> <span class="token number">0.8640</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
               <span class="token punctuation">[</span><span class="token number">0.4480</span><span class="token punctuation">,</span> <span class="token number">0.6117</span><span class="token punctuation">,</span> <span class="token number">0.1009</span><span class="token punctuation">,</span> <span class="token number">0.5133</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
               <span class="token punctuation">[</span><span class="token number">0.3943</span><span class="token punctuation">,</span> <span class="token number">0.6957</span><span class="token punctuation">,</span> <span class="token number">0.3163</span><span class="token punctuation">,</span> <span class="token number">0.3692</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
               <span class="token punctuation">[</span><span class="token number">0.3349</span><span class="token punctuation">,</span> <span class="token number">0.6954</span><span class="token punctuation">,</span> <span class="token number">0.1955</span><span class="token punctuation">,</span> <span class="token number">0.3640</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
xyxy<span class="token punctuation">:</span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">7.8548e+02</span><span class="token punctuation">,</span> <span class="token number">5.1154e-01</span><span class="token punctuation">,</span> <span class="token number">1.0214e+03</span><span class="token punctuation">,</span> <span class="token number">6.2262e+02</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token punctuation">[</span><span class="token number">5.0879e+02</span><span class="token punctuation">,</span> <span class="token number">2.5563e+02</span><span class="token punctuation">,</span> <span class="token number">6.3798e+02</span><span class="token punctuation">,</span> <span class="token number">6.2519e+02</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token punctuation">[</span><span class="token number">3.0231e+02</span><span class="token punctuation">,</span> <span class="token number">3.6799e+02</span><span class="token punctuation">,</span> <span class="token number">7.0716e+02</span><span class="token punctuation">,</span> <span class="token number">6.3381e+02</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token punctuation">[</span><span class="token number">3.0361e+02</span><span class="token punctuation">,</span> <span class="token number">3.6963e+02</span><span class="token punctuation">,</span> <span class="token number">5.5384e+02</span><span class="token punctuation">,</span> <span class="token number">6.3172e+02</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
xyxyn<span class="token punctuation">:</span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">6.1366e-01</span><span class="token punctuation">,</span> <span class="token number">7.1047e-04</span><span class="token punctuation">,</span> <span class="token number">7.9797e-01</span><span class="token punctuation">,</span> <span class="token number">8.6476e-01</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
               <span class="token punctuation">[</span><span class="token number">3.9750e-01</span><span class="token punctuation">,</span> <span class="token number">3.5505e-01</span><span class="token punctuation">,</span> <span class="token number">4.9842e-01</span><span class="token punctuation">,</span> <span class="token number">8.6832e-01</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
               <span class="token punctuation">[</span><span class="token number">2.3618e-01</span><span class="token punctuation">,</span> <span class="token number">5.1109e-01</span><span class="token punctuation">,</span> <span class="token number">5.5247e-01</span><span class="token punctuation">,</span> <span class="token number">8.8029e-01</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
               <span class="token punctuation">[</span><span class="token number">2.3720e-01</span><span class="token punctuation">,</span> <span class="token number">5.1338e-01</span><span class="token punctuation">,</span> <span class="token number">4.3269e-01</span><span class="token punctuation">,</span> <span class="token number">8.7739e-01</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">As you can see, there is quite a lot of information in the <code>boxes</code> attribute and they are quite easy to understand.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">The one that we are interested in is the <code>data</code> attribute. It contains the bounding boxes in the format <code>[x1, y1, x2, y2, confidence, class_id]</code>.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">The <code>x1</code>, <code>y1</code>, <code>x2</code>, <code>y2</code> are the coordinates of the bounding box. The <code>confidence</code> is the confidence of the bounding box and the <code>class_id</code> is the id of the class that the bounding box belongs to.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Let's see how we can use this information to draw the bounding boxes on the image:</span></span></p>
<div class="code-toolbar"><pre class=" language-python"><code class=" language-python">    <span class="token comment"># loop over the results</span>
    <span class="token keyword">for</span> result <span class="token keyword">in</span> results<span class="token punctuation">:</span>
        <span class="token comment"># initialize the list of bounding boxes, confidences, and class IDs</span>
        bboxes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        confidences <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        class_ids <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token comment"># loop over the detections</span>
        <span class="token keyword">for</span> data <span class="token keyword">in</span> result<span class="token punctuation">.</span>boxes<span class="token punctuation">.</span>data<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y2<span class="token punctuation">,</span> confidence<span class="token punctuation">,</span> class_id <span class="token operator">=</span> data
            x <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x1<span class="token punctuation">)</span>
            y <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>y1<span class="token punctuation">)</span>
            w <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x2<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x1<span class="token punctuation">)</span>
            h <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>y2<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">int</span><span class="token punctuation">(</span>y1<span class="token punctuation">)</span>
            class_id <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>class_id<span class="token punctuation">)</span>
            <span class="token comment"># filter out weak predictions by ensuring the confidence is</span>
            <span class="token comment"># greater than the minimum confidence</span>
            <span class="token keyword">if</span> confidence <span class="token operator">&gt;</span> conf_threshold<span class="token punctuation">:</span>
                bboxes<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">]</span><span class="token punctuation">)</span>
                confidences<span class="token punctuation">.</span>append<span class="token punctuation">(</span>confidence<span class="token punctuation">)</span>
                class_ids<span class="token punctuation">.</span>append<span class="token punctuation">(</span>class_id<span class="token punctuation">)</span>
                cv2<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> w<span class="token punctuation">,</span> y <span class="token operator">+</span> h<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Here, we are using <code>result.boxes.data.tolist()</code> to get the detections in the format <code>[x1, y1, x2, y2, confidence, class_id]</code>.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Next, we check if the confidence of the bounding box is greater than the <code>conf_threshold</code>. If it is, we add the bounding box, confidence, and class_id to their respective lists.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Finally, we draw the bounding boxes on the image using <code>cv2.rectangle()</code>.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Let's finish our code by writing the fps on the frame and displaying the frame.</span></span></p>
<div class="code-toolbar"><pre class=" language-python"><code class=" language-python">    <span class="token comment">############################################################</span>
    <span class="token comment">### Some post-processing to display the results          ###</span>
    <span class="token comment">############################################################</span>
    <span class="token comment"># end time to compute the fps</span>
    end <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># calculate the frame per second and draw it on the frame</span>
    fps <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"FPS: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
    cv2<span class="token punctuation">.</span>putText<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> fps<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                cv2<span class="token punctuation">.</span>FONT_HERSHEY_SIMPLEX<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
    <span class="token comment"># show the output frame</span>
    cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">"Output"</span><span class="token punctuation">,</span> frame<span class="token punctuation">)</span>
    <span class="token comment"># write the frame to disk</span>
    writer<span class="token punctuation">.</span>write<span class="token punctuation">(</span>frame<span class="token punctuation">)</span>
    <span class="token keyword">if</span> cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"q"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>

<span class="token comment"># release the video capture, video writer, and close all windows</span>
video_cap<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>
writer<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>destroyAllWindows<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
<p><span style="font-family: helvetica, arial, sans-serif; font-size: 12pt;">The video below shows the output of the code:</span></p>
<p style="text-align: center;"><span style="font-family: helvetica, arial, sans-serif; font-size: 12pt;"><iframe data-ezsrc="//www.youtube.com/embed/Uot5hHZeTZU" width="560" height="314" allowfullscreen="allowfullscreen" class=" ezlazyloading" ezoid="0.644776656488822" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/saved_resource(4).html"></iframe></span></p>
<p style="text-align: center;"><span style="font-size: 10pt;"><em><span style="font-family: helvetica, arial, sans-serif;">Object Detection with YOLOv8</span></em></span></p>
<p style="text-align: left;"><span style="font-family: helvetica, arial, sans-serif; font-size: 12pt;"><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">As you can see, the code is working fine. It's easy to use the YOLOv8 for object detection.</span></span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Let's move now to the interesting part of the tutorial. We will see how we can track the objects detected by YOLOv8.</span></span></p>
<h2><span style="font-size: 18pt;"><a id="real-time-object-tracking-with-deepsort-and-opencv"></a><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 24px;">Real-Time Object Tracking with DeepSORT and OpenCV</span></span></span></h2>
<p><span style="font-size: 12pt;"><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Please note that a lot of the code of this section is grabbed from <a title="Real-time Object Tracking with OpenCV and YOLOv8 in Python" href="https://thepythoncode.com/article/real-time-object-tracking-with-yolov8-opencv" target="_blank" rel="noopener">this tutorial</a>.</span></span></span></p>
<p><span style="font-size: 12pt;"><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">We first need to import some classes and functions from the <code>deep_sort</code> package:</span></span></span></p>
<div class="code-toolbar"><pre class=" language-python"><code class=" language-python"><span class="token comment"># ...</span>
<span class="token keyword">from</span> deep_sort<span class="token punctuation">.</span>deep_sort<span class="token punctuation">.</span>tracker <span class="token keyword">import</span> Tracker
<span class="token keyword">from</span> deep_sort<span class="token punctuation">.</span>deep_sort <span class="token keyword">import</span> nn_matching
<span class="token keyword">from</span> deep_sort<span class="token punctuation">.</span>deep_sort<span class="token punctuation">.</span>detection <span class="token keyword">import</span> Detection
<span class="token keyword">from</span> deep_sort<span class="token punctuation">.</span>tools <span class="token keyword">import</span> generate_detections <span class="token keyword">as</span> gdet

<span class="token comment"># define some parameters</span>
conf_threshold <span class="token operator">=</span> <span class="token number">0.5</span>
max_cosine_distance <span class="token operator">=</span> <span class="token number">0.4</span>
nn_budget <span class="token operator">=</span> <span class="token boolean">None</span>

<span class="token comment"># ...</span>

<span class="token comment"># Initialize the deep sort tracker</span>
model_filename <span class="token operator">=</span> <span class="token string">"config/mars-small128.pb"</span>
encoder <span class="token operator">=</span> gdet<span class="token punctuation">.</span>create_box_encoder<span class="token punctuation">(</span>model_filename<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
metric <span class="token operator">=</span> nn_matching<span class="token punctuation">.</span>NearestNeighborDistanceMetric<span class="token punctuation">(</span>
    <span class="token string">"cosine"</span><span class="token punctuation">,</span> max_cosine_distance<span class="token punctuation">,</span> nn_budget<span class="token punctuation">)</span>
tracker <span class="token operator">=</span> Tracker<span class="token punctuation">(</span>metric<span class="token punctuation">)</span>
<span class="token comment"># load the COCO class labels the YOLO model was trained on</span>
classes_path <span class="token operator">=</span> <span class="token string">"config/coco.names"</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>classes_path<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    class_names <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
<span class="token comment"># create a list of random colors to represent each class</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span>  <span class="token comment"># to get the same colors</span>
colors <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>class_names<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># (80, 3)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">We first need to load the <code>mars-small128.pb</code> model. This model is used to extract the features of the bounding boxes.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Next, we create a <code>NearestNeighborDistanceMetric</code> object. This object is used to compute the distance between the features extracted by the <code>mars-small128.pb</code> model.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Finally, we create a <code>Tracker</code> object. This object is used to track the objects detected by YOLOv8.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">We also need to load the <code>coco.names</code> file. This file contains the names of the classes the YOLOv8 model was trained on. We will use this file to get the name of the class the bounding box belongs to.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">We also create a list of random colors to represent each class. We will draw the bounding boxes of each class with a different color. This will help us to distinguish between the different classes (cars, trucks, motorbikes, etc.)</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Let's continue our code, we will see how we can use the <code>Tracker</code> object to track the objects detected by YOLOv8:</span></span></p>
<div class="code-toolbar"><pre class=" language-python"><code class=" language-python"><span class="token comment"># loop over the frames</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token comment"># ...</span>
    <span class="token comment">############################################################</span>
    <span class="token comment">### Detect the objects in the frame using the YOLO model ###</span>
    <span class="token comment">############################################################</span>
    results <span class="token operator">=</span> model<span class="token punctuation">(</span>frame<span class="token punctuation">)</span>
    <span class="token keyword">for</span> result <span class="token keyword">in</span> results<span class="token punctuation">:</span>
        <span class="token comment"># ...</span>
        <span class="token keyword">for</span> data <span class="token keyword">in</span> result<span class="token punctuation">.</span>boxes<span class="token punctuation">.</span>data<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># ...</span>
            <span class="token keyword">if</span> confidence <span class="token operator">&gt;</span> conf_threshold<span class="token punctuation">:</span>
                bboxes<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">]</span><span class="token punctuation">)</span>
                confidences<span class="token punctuation">.</span>append<span class="token punctuation">(</span>confidence<span class="token punctuation">)</span>
                class_ids<span class="token punctuation">.</span>append<span class="token punctuation">(</span>class_id<span class="token punctuation">)</span>
                <span class="token comment"># cv2.rectangle(frame, (x, y), (x + w, y + h), (0, 255, 0), 2) # comment this line    </span>
    <span class="token comment">############################################################</span>
    <span class="token comment">### Track the objects in the frame using DeepSort        ###</span>
    <span class="token comment">############################################################</span>
    <span class="token comment"># get the names of the detected objects</span>
    names <span class="token operator">=</span> <span class="token punctuation">[</span>class_names<span class="token punctuation">[</span>class_id<span class="token punctuation">]</span> <span class="token keyword">for</span> class_id <span class="token keyword">in</span> class_ids<span class="token punctuation">]</span>
    <span class="token comment"># get the features of the detected objects</span>
    features <span class="token operator">=</span> encoder<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> bboxes<span class="token punctuation">)</span>
    <span class="token comment"># convert the detections to deep sort format</span>
    dets <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> bbox<span class="token punctuation">,</span> conf<span class="token punctuation">,</span> class_name<span class="token punctuation">,</span> feature <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>bboxes<span class="token punctuation">,</span> confidences<span class="token punctuation">,</span> names<span class="token punctuation">,</span> features<span class="token punctuation">)</span><span class="token punctuation">:</span>
        dets<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Detection<span class="token punctuation">(</span>bbox<span class="token punctuation">,</span> conf<span class="token punctuation">,</span> class_name<span class="token punctuation">,</span> feature<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># run the tracker on the detections</span>
    tracker<span class="token punctuation">.</span>predict<span class="token punctuation">(</span><span class="token punctuation">)</span>
    tracker<span class="token punctuation">.</span>update<span class="token punctuation">(</span>dets<span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Let's understand the code above. After detecting the objects in the frame using the YOLOv8 model, we filter the detections to keep only those with a confidence greater than <code>conf_threshold</code> and we add the bounding box, confidence, and <code>class_id</code> of each detection to their respective lists.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Next, we get the names of the detected objects using the <code>class_names</code> and the <code>class_ids</code> lists.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">After that, we get the features of the detected objects using the <code>encoder</code> object.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Finally, we convert the detections to the <code>deep_sort</code> format and we run the tracker on the detections.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Now we can loop over the tracked objects and draw the bounding boxes on the frame:</span></span></p>
<div class="code-toolbar"><pre class=" language-python"><code class=" language-python">    <span class="token comment"># loop over the tracked objects</span>
    <span class="token keyword">for</span> track <span class="token keyword">in</span> tracker<span class="token punctuation">.</span>tracks<span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> track<span class="token punctuation">.</span>is_confirmed<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">or</span> track<span class="token punctuation">.</span>time_since_update <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>
        <span class="token comment"># get the bounding box of the object, the name</span>
        <span class="token comment"># of the object, and the track id</span>
        bbox <span class="token operator">=</span> track<span class="token punctuation">.</span>to_tlbr<span class="token punctuation">(</span><span class="token punctuation">)</span>
        track_id <span class="token operator">=</span> track<span class="token punctuation">.</span>track_id
        class_name <span class="token operator">=</span> track<span class="token punctuation">.</span>get_class<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># convert the bounding box to integers</span>
        x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y2 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>bbox<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>bbox<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>bbox<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>bbox<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token comment"># get the color associated with the class name</span>
        class_id <span class="token operator">=</span> class_names<span class="token punctuation">.</span>index<span class="token punctuation">(</span>class_name<span class="token punctuation">)</span>
        color <span class="token operator">=</span> colors<span class="token punctuation">[</span>class_id<span class="token punctuation">]</span>
        B<span class="token punctuation">,</span> G<span class="token punctuation">,</span> R <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>color<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>color<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>color<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token comment"># draw the bounding box of the object, the name</span>
        <span class="token comment"># of the predicted object, and the track id</span>
        text <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>track_id<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" - "</span> <span class="token operator">+</span> class_name
        cv2<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> <span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x2<span class="token punctuation">,</span> y2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>B<span class="token punctuation">,</span> G<span class="token punctuation">,</span> R<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> <span class="token punctuation">(</span>x1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> y1 <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                      <span class="token punctuation">(</span>x1 <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">12</span><span class="token punctuation">,</span> y1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>B<span class="token punctuation">,</span> G<span class="token punctuation">,</span> R<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>putText<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token punctuation">(</span>x1 <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">,</span> y1 <span class="token operator">-</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    cv2<span class="token punctuation">.</span>FONT_HERSHEY_SIMPLEX<span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">After tracking the objects in the frame, we loop over the tracked objects and check if the track is confirmed. If not, we skip it. </span></span><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Otherwise, we get the bounding box of the object, its name, and the track id.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">We also get the color associated with the class name and use it to draw the bounding box of the object.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Finally, we can reuse the same code as in the object detection part to draw the fps, save and show the frame.</span></span></p>
<div class="code-toolbar"><pre class=" language-python"><code class=" language-python">    <span class="token comment">############################################################</span>
    <span class="token comment">### Some post-processing to display the results          ###</span>
    <span class="token comment">############################################################</span>
    <span class="token comment"># end time to compute the fps</span>
    end <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># calculate the frame per second and draw it on the frame</span>
    fps <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"FPS: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
    cv2<span class="token punctuation">.</span>putText<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> fps<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                cv2<span class="token punctuation">.</span>FONT_HERSHEY_SIMPLEX<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
    <span class="token comment"># show the output frame</span>
    cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">"Output"</span><span class="token punctuation">,</span> frame<span class="token punctuation">)</span>
    <span class="token comment"># write the frame to disk</span>
    writer<span class="token punctuation">.</span>write<span class="token punctuation">(</span>frame<span class="token punctuation">)</span>
    <span class="token keyword">if</span> cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"q"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
<span class="token comment"># release the video capture, video writer, and close all windows</span>
video_cap<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>
writer<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>destroyAllWindows<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
<p><span style="font-family: helvetica, arial, sans-serif; font-size: 12pt;">The video below is the same video used in the previous section for object detection:</span></p>
<p style="text-align: center;"><span style="font-family: helvetica, arial, sans-serif; font-size: 12pt;"><iframe data-ezsrc="//www.youtube.com/embed/IFCBG9YbO8U" width="560" height="314" allowfullscreen="allowfullscreen" class=" ezlazyloading" ezoid="0.9917180894477764" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/saved_resource(5).html"></iframe></span></p>
<p style="text-align: center;"><em><span style="font-family: helvetica, arial, sans-serif; font-size: 10pt;"><span style="font-family: helvetica, arial, sans-serif;">Object Tracking with DeepSORT</span></span></em></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">You can see that the tracker is able to re-identify some of the cars after losing the bounding box for a few frames. This is because the tracker is able to assign a unique ID to each object and maintain its identity across frames.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Ok, great! We now know how to detect and track objects in a video. Let's see how we can use this to count the number of cars in a video.</span></span></p>
<h2><span style="font-size: 18pt;"><a id="vehicle-counting-with-yolov8-and-deepsort"></a><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 24px;">Vehicle Counting with YOLOv8 and DeepSORT</span></span></span></h2>
<p><span style="font-size: 12pt;"><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Counting the number of cars in a video is straightforward. All we need to do is count the number of unique IDs assigned to the cars by the tracker.</span></span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">First, we need to draw 3 lines (hardcoding) on the frame (one for each lane in the video). These lines will be used to count the number of cars:</span></span></p>
<div class="code-toolbar"><pre class=" language-python"><code class=" language-python"><span class="token keyword">from</span> collections <span class="token keyword">import</span> deque

<span class="token comment"># ...</span>
<span class="token comment"># define some parameters</span>
conf_threshold <span class="token operator">=</span> <span class="token number">0.5</span>
max_cosine_distance <span class="token operator">=</span> <span class="token number">0.4</span>
nn_budget <span class="token operator">=</span> <span class="token boolean">None</span>
points <span class="token operator">=</span> <span class="token punctuation">[</span>deque<span class="token punctuation">(</span>maxlen<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># list of deques to store the points</span>
counter_A <span class="token operator">=</span> <span class="token number">0</span>
counter_B <span class="token operator">=</span> <span class="token number">0</span>
counter_C <span class="token operator">=</span> <span class="token number">0</span>
start_line_A <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">480</span><span class="token punctuation">)</span>
end_line_A <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">480</span><span class="token punctuation">)</span>
start_line_B <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">525</span><span class="token punctuation">,</span> <span class="token number">480</span><span class="token punctuation">)</span>
end_line_B <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">745</span><span class="token punctuation">,</span> <span class="token number">480</span><span class="token punctuation">)</span>
start_line_C <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">895</span><span class="token punctuation">,</span> <span class="token number">480</span><span class="token punctuation">)</span>
end_line_C <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1165</span><span class="token punctuation">,</span> <span class="token number">480</span><span class="token punctuation">)</span>

<span class="token comment"># ...</span>

<span class="token comment"># loop over the frames</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token comment"># starter time to computer the fps</span>
    start <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ret<span class="token punctuation">,</span> frame <span class="token operator">=</span> video_cap<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    overlay <span class="token operator">=</span> frame<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># draw the lines</span>
    cv2<span class="token punctuation">.</span>line<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> start_line_A<span class="token punctuation">,</span> end_line_A<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>
    cv2<span class="token punctuation">.</span>line<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> start_line_B<span class="token punctuation">,</span> end_line_B<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>
    cv2<span class="token punctuation">.</span>line<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> start_line_C<span class="token punctuation">,</span> end_line_C<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>
    
    frame <span class="token operator">=</span> cv2<span class="token punctuation">.</span>addWeighted<span class="token punctuation">(</span>overlay<span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> frame<span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

    <span class="token comment"># ...</span>
    <span class="token comment">############################################################</span>
    <span class="token comment">### Some post-processing to display the results          ###</span>
    <span class="token comment">############################################################</span>
    <span class="token comment"># end time to compute the fps</span>
    end <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># calculate the frame per second and draw it on the frame</span>
    fps <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"FPS: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
    cv2<span class="token punctuation">.</span>putText<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> fps<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                cv2<span class="token punctuation">.</span>FONT_HERSHEY_SIMPLEX<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
    <span class="token comment"># draw the total number of vehicles passing the lines</span>
    cv2<span class="token punctuation">.</span>putText<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> <span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">483</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>FONT_HERSHEY_SIMPLEX<span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    cv2<span class="token punctuation">.</span>putText<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">530</span><span class="token punctuation">,</span> <span class="token number">483</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>FONT_HERSHEY_SIMPLEX<span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    cv2<span class="token punctuation">.</span>putText<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">910</span><span class="token punctuation">,</span> <span class="token number">483</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>FONT_HERSHEY_SIMPLEX<span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    cv2<span class="token punctuation">.</span>putText<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>counter_A<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">270</span><span class="token punctuation">,</span> <span class="token number">483</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>FONT_HERSHEY_SIMPLEX<span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    cv2<span class="token punctuation">.</span>putText<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>counter_B<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">620</span><span class="token punctuation">,</span> <span class="token number">483</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>FONT_HERSHEY_SIMPLEX<span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    cv2<span class="token punctuation">.</span>putText<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>counter_C<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1040</span><span class="token punctuation">,</span> <span class="token number">483</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>FONT_HERSHEY_SIMPLEX<span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token comment"># ...</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Here we are importing the <code>deque</code> class from the <code>collections</code> module. We will use this class to store the center points of the bounding boxes of the cars.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">We will later use them to draw the trajectories of the cars and to count the number of cars.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">As you can see, we are creating 1000 deques which is the maximum number of objects that we can track at the same time. You can change this number if you have more or fewer objects to track.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">We are also defining 3 lines (one for each lane) and drawing them on the frame. I have chosen the coordinates of the lines manually by looking at the video, so make sure to change those whenever you change the video.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">To make the lines more transparent, we are using the <code>cv2.addWeighted()</code> function to add the frame and the overlay.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Finally, we display the total number of cars passing each line on the frame. We will update these numbers later when we count the number of cars.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Let's see the output of the code:</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;"><img style="display: block; margin-left: auto; margin-right: auto; visibility: visible;" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/lines-drawn-on-the-frame-min.png" alt="" width="600" height="378" data-xblocker="passed"></span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;"><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">So far so good! Now we can start implementing the counting part of the project:</span></span></span></span></p>
<div class="code-toolbar"><pre class=" language-python"><code class=" language-python"><span class="token comment"># loop over the frames</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token comment"># ...</span>
    <span class="token keyword">for</span> result <span class="token keyword">in</span> results<span class="token punctuation">:</span>
        <span class="token comment"># ...</span>
        <span class="token keyword">for</span> data <span class="token keyword">in</span> result<span class="token punctuation">.</span>boxes<span class="token punctuation">.</span>data<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># ...      </span>
    <span class="token comment">############################################################</span>
    <span class="token comment">### Track the objects in the frame using DeepSort        ###</span>
    <span class="token comment">############################################################</span>
    <span class="token comment"># ...</span>
    <span class="token comment"># loop over the tracked objects</span>
    <span class="token keyword">for</span> track <span class="token keyword">in</span> tracker<span class="token punctuation">.</span>tracks<span class="token punctuation">:</span>
        <span class="token comment"># ...</span>
        <span class="token comment"># draw the bounding box of the object, the name</span>
        <span class="token comment"># of the predicted object, and the track id</span>
        text <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>track_id<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" - "</span> <span class="token operator">+</span> class_name
        cv2<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> <span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x2<span class="token punctuation">,</span> y2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>B<span class="token punctuation">,</span> G<span class="token punctuation">,</span> R<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> <span class="token punctuation">(</span>x1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> y1 <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                      <span class="token punctuation">(</span>x1 <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">12</span><span class="token punctuation">,</span> y1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>B<span class="token punctuation">,</span> G<span class="token punctuation">,</span> R<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>putText<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token punctuation">(</span>x1 <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">,</span> y1 <span class="token operator">-</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    cv2<span class="token punctuation">.</span>FONT_HERSHEY_SIMPLEX<span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token comment">############################################################</span>
        <span class="token comment">### Count the number of vehicles passing the lines       ###</span>
        <span class="token comment">############################################################</span>
        center_x <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x1 <span class="token operator">+</span> x2<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span>
        center_y <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y1 <span class="token operator">+</span> y2<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token comment"># append the center point of the current object to the points list</span>
        points<span class="token punctuation">[</span>track_id<span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>center_x<span class="token punctuation">,</span> center_y<span class="token punctuation">)</span><span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>circle<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> <span class="token punctuation">(</span>center_x<span class="token punctuation">,</span> center_y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>        
        <span class="token comment"># loop over the set of tracked points and draw them</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>points<span class="token punctuation">[</span>track_id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            point1 <span class="token operator">=</span> points<span class="token punctuation">[</span>track_id<span class="token punctuation">]</span><span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
            point2 <span class="token operator">=</span> points<span class="token punctuation">[</span>track_id<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span>
            <span class="token comment"># if the previous point or the current point is None, do nothing</span>
            <span class="token keyword">if</span> point1 <span class="token keyword">is</span> <span class="token boolean">None</span> <span class="token keyword">or</span> point2 <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
            cv2<span class="token punctuation">.</span>line<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> <span class="token punctuation">(</span>point1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>point2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">After tracking the objects in the frame, we loop over the tracked objects and get the center point of the bounding box of each object.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">We then append the center point of the current tracked object to the <code>points</code> list and draw it on the frame.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Finally, we loop over the <code>points</code> list and draw the trajectories of the tracked objects.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Here is what the output looks like:</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;"><img style="display: block; margin-left: auto; margin-right: auto; visibility: visible;" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/trajectories-drawn-o_adqUUJt.png" alt="" width="600" height="378" data-xblocker="passed"></span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">As you can see, each car has now its own trajectory. We can use these trajectories to count the number of cars passing the lines.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Below the previous code, add the following code:</span></span></p>
<div class="code-toolbar"><pre class=" language-python"><code class=" language-python">        <span class="token comment"># get the last point from the points list and draw it</span>
        last_point_x <span class="token operator">=</span> points<span class="token punctuation">[</span>track_id<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        last_point_y <span class="token operator">=</span> points<span class="token punctuation">[</span>track_id<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        cv2<span class="token punctuation">.</span>circle<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>last_point_x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>last_point_y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>    
        <span class="token comment"># if the y coordinate of the center point is below the line, and the x coordinate is </span>
        <span class="token comment"># between the start and end points of the line, and the the last point is above the line,</span>
        <span class="token comment"># increment the total number of cars crossing the line and remove the center points from the list</span>
        <span class="token keyword">if</span> center_y <span class="token operator">&gt;</span> start_line_A<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">and</span> start_line_A<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> center_x <span class="token operator">&lt;</span> end_line_A<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">and</span> last_point_y <span class="token operator">&lt;</span> start_line_A<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            counter_A <span class="token operator">+=</span> <span class="token number">1</span>
            points<span class="token punctuation">[</span>track_id<span class="token punctuation">]</span><span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> center_y <span class="token operator">&gt;</span> start_line_B<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">and</span> start_line_B<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> center_x <span class="token operator">&lt;</span> end_line_B<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">and</span> last_point_y <span class="token operator">&lt;</span> start_line_A<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            counter_B <span class="token operator">+=</span> <span class="token number">1</span>
            points<span class="token punctuation">[</span>track_id<span class="token punctuation">]</span><span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> center_y <span class="token operator">&gt;</span> start_line_C<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">and</span> start_line_C<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> center_x <span class="token operator">&lt;</span> end_line_C<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">and</span> last_point_y <span class="token operator">&lt;</span> start_line_A<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            counter_C <span class="token operator">+=</span> <span class="token number">1</span>
            points<span class="token punctuation">[</span>track_id<span class="token punctuation">]</span><span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">In the code above, we are getting the last point from the <code>points</code> list and draw it on the frame.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Then we check if the <code>y</code> coordinate of the center point is below the line, the <code>x</code> coordinate is between the start and end points of the line and the last point in the <code>points</code> list is above the line.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">If this is the case, we can confidently say that a car has crossed the line. So we increment the counter (A, B, or C depending on the line) and remove the center points of the car from the <code>points</code> list.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">The video below shows the final output of the code:</span></span></p>
<p style="text-align: center;"><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;"><iframe data-ezsrc="//www.youtube.com/embed/e1b0XsV_SSE" width="560" height="314" allowfullscreen="allowfullscreen" class=" ezlazyloading" ezoid="0.4020922040144188" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/saved_resource(6).html"></iframe></span></span></p>
<p style="text-align: center;"><em><span style="font-family: helvetica, arial, sans-serif; font-size: 10pt;">Vehicle Counting with YOLOv8 and DeepSORT</span></em></p>
<h2 style="text-align: left;"><span style="font-size: 18pt;"><a id="summary"></a><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 24px;">Summary</span></span></span></h2>
<p><span style="font-size: 12pt;"><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">In this hands-on tutorial, you learned how to use the DeepSORT algorithm and the YOLOv8 model to detect, track, and count objects in a video.</span></span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">You learned how to assign a unique ID to each object and how to re-identify the object after losing the bounding box for a few frames.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">You now have all the tools you need to build your own object-tracking and counting system. </span></span><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">I hope you enjoyed this tutorial and that you learned something new.</span></span></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">You can get <a href="https://thepythoncode.com/code/real-time-vehicle-tracking-and-counting-with-yolov8-opencv" target="_blank" rel="noopener">the complete project code here</a>.</span></span></p>
<p><em><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;"><strong>Related tutorial:</strong> <a title="How to Perform YOLO Object Detection using OpenCV in Python" href="https://thepythoncode.com/article/yolo-object-detection-with-opencv-and-pytorch-in-python" target="_blank" rel="noopener">How to Perform YOLO Object Detection using OpenCV in Python</a>.</span></span></em></p>
<p><span style="font-family: helvetica, arial, sans-serif;"><span style="font-size: 16px;">Happy coding ♥</span></span></p>
<p style="font-family: Inter; font-size: 12pt;"><i>Ready for more? Dive deeper into coding with our <a class="code-explainer-text" target="_blank" href="https://codingfleet.com/code-explainer/python/">AI-powered Code Explainer</a>. Don't miss it!</i></p>

<a target="_blank" href="https://thepythoncode.com/code/real-time-vehicle-tracking-and-counting-with-yolov8-opencv" class="btn btn-outline-primary"><i class="fa fa-code"></i> View Full Code</a>
<a target="_blank" id="code-assistant-link" href="https://codingfleet.com/code-assistant/python/" class="btn btn-outline-success">
            <i class="fa fa-robot"></i> Fix My Code</a>


<div align="center">
    <span style="font-size: 14px;">Sharing is caring!</span>
    <br><br>
    <a href="javascript:void(0);" class="fb-share">
        <span class="fa-stack fa-lg">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-facebook-f fa-stack-1x fa-inverse"></i>
        </span>
    </a>
    <a href="javascript:void(0);" class="twitter-share">
        <span class="fa-stack fa-lg">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
        </span>
    </a>
</div>
<br><br>





<h3 class="text-info">Read Also</h3><br>

<div class="card" style="margin-top: 5px">
    <div class="row">
        <div class="col-sm-4">
            <a href="https://thepythoncode.com/article/real-time-object-tracking-with-yolov8-opencv"><img class="card-img-top" style="padding: 0.35em; visibility: visible;" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/real-time-object-tracking-yolov8_compressed.jpg" alt="Real-time Object Tracking with OpenCV and YOLOv8 in Python" data-xblocker="passed"></a>
        </div>
        <div class="col-sm">
            <div class="card-body">
                <a href="https://thepythoncode.com/article/real-time-object-tracking-with-yolov8-opencv" style="text-decoration: none;"><h4 class="card-title" style="margin: 0">Real-time Object Tracking with OpenCV and YOLOv8 in Python</h4></a>
                <div class="row">
                    <div class="col-12">
                        <a href="https://thepythoncode.com/article/real-time-object-tracking-with-yolov8-opencv" style="text-decoration: none;"><p class="text-secondary" style="font-size:15px;">Learn how to perform real-time object tracking with the DeepSORT algorithm and YOLOv8 using the OpenCV library in Python.</p></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>




<div class="card" style="margin-top: 5px">
    <div class="row">
        <div class="col-sm-4">
            <a href="https://thepythoncode.com/article/yolo-object-detection-with-opencv-and-pytorch-in-python"><img class="card-img-top" style="padding: 0.35em; visibility: visible;" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/object-detection-yolo-with-pytorch-and-opencv-in-python.jpg" alt="How to Perform YOLO Object Detection using OpenCV in Python" data-xblocker="passed"></a>
        </div>
        <div class="col-sm">
            <div class="card-body">
                <a href="https://thepythoncode.com/article/yolo-object-detection-with-opencv-and-pytorch-in-python" style="text-decoration: none;"><h4 class="card-title" style="margin: 0">How to Perform YOLO Object Detection using OpenCV in Python</h4></a>
                <div class="row">
                    <div class="col-12">
                        <a href="https://thepythoncode.com/article/yolo-object-detection-with-opencv-and-pytorch-in-python" style="text-decoration: none;"><p class="text-secondary" style="font-size:15px;">Using the state-of-the-art YOLOv8 object detection for real-time object detection, recognition and localization in Python using OpenCV, Ultralytics and PyTorch.</p></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>




<div class="card" style="margin-top: 5px">
    <div class="row">
        <div class="col-sm-4">
            <a href="https://thepythoncode.com/article/finetune-vit-for-image-classification-using-transformers-in-python"><img class="card-img-top" style="padding: 0.35em; visibility: visible;" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/finetuning-vit-for-image-classification-using-transformers.jpg" alt="How to Fine Tune ViT for Image Classification using Transformers in Python" data-xblocker="passed"></a>
        </div>
        <div class="col-sm">
            <div class="card-body">
                <a href="https://thepythoncode.com/article/finetune-vit-for-image-classification-using-transformers-in-python" style="text-decoration: none;"><h4 class="card-title" style="margin: 0">How to Fine Tune ViT for Image Classification using Transformers in Python</h4></a>
                <div class="row">
                    <div class="col-12">
                        <a href="https://thepythoncode.com/article/finetune-vit-for-image-classification-using-transformers-in-python" style="text-decoration: none;"><p class="text-secondary" style="font-size:15px;">Learn how to fine tune the Vision Transformer (ViT) model for the image classification task using the Huggingface Transformers, evaluate, and datasets libraries in Python.</p></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<br>
<h3>Comment panel</h3>
<div class="row bootstrap snippets">
    <div class="media-list"></div>
    <div class="col-md-12 col-md-offset-2 col-sm-12">
        <div class="comment-wrapper">
            <div class="panel panel-info">  
                <div id="success"></div>
                <div id="replies"></div>
                <div id="name-invalid"></div>
                <div id="email-invalid"></div>
                <div id="content-invalid"></div>
                <div class="panel-body">
                    <div class="code-assistant-prompt">
                        <p style="font-size: 12pt; font-family: Inter, Helvetica, sans-serif;"><i>Got a coding query or need some guidance before you comment? Check out this <a target="_blank" href="https://codingfleet.com/code-assistant/python/">Python Code Assistant</a> for expert advice and handy tips. It's like having a coding tutor right in your fingertips!</i></p>
                    </div>
                    <form>
                        <input type="hidden" name="csrfmiddlewaretoken" value="xM1B5AIqQVdA4PRnHZbBUH6QwT0iL8MEFqvfUfU2b1qwZU35BrIAYoPeUn5i5SQS">
                        <div class="form-group" style="margin-bottom: 15px;">
                            <input class="form-control" placeholder="Enter your name" value="" type="text" name="name" required="" id="name">
                        </div>
                        <div class="form-group" style="margin-bottom: 15px;">
                            <label style="font-size: 10.7pt;"><i>Your email address will not be published.</i></label>
                            <input class="form-control" placeholder="Enter Email" value="" type="email" name="email" required="" id="email">
                        </div>
                        <input type="hidden" name="reply-to" id="reply-to" value="">
                        <textarea maxlength="5000" class="form-control" id="comment-content" placeholder="Write a comment..." rows="4"></textarea>
                        <br>
                        <div id="recaptcha-invalid"></div>
                        <div id="html_element"><div style="width: 304px; height: 78px;"><div><iframe title="reCAPTCHA" width="304" height="78" role="presentation" name="a-acgdeegi5rdw" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/anchor.html"></iframe></div><textarea id="g-recaptcha-response" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div></div>
                        <br>
                        <div class="control-group">
                            <div class="form-group controls">
                            <input type="checkbox" checked="checked" name="subscribe" id="subscribe">
                            <label>Subscribe for our newsletter</label>
                            </div>
                        </div>
                        <br>
                        <input type="submit" id="submit-comment" class="btn btn-outline-primary pull-right" value="Comment">
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

            </div>
            
<div class="col-12 col-md-3 col-xl-3">
    <br>
    
    
    <a href="https://thepythoncode.com/build-an-automatic-number-plate-recognition-system-with-opencv-and-yolo-ebook?utm_source=topic-article&amp;utm_medium=banner&amp;utm_campaign=square-top" target="_blank" rel="noopener">
        <img src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/mastering-yolo-banner.jpg" alt="Mastering YOLO - Topic - Top" data-xblocker="passed" style="visibility: visible;">
    </a>
    <br><span id="ezoic-pub-ad-placeholder-149" class="ezoic-adpicker-ad"></span><span data-ez-ph-id="149"></span>
    <br>
    
    
    
    
    
    
    <!-- End Ezoic - sidebar - sidebar -->
    <br>
    <div class="modal-dialog modal-newsletter">
		<div class="modal-content">
			<form action="https://thepythoncode.com/subscribe" method="POST" id="form-sidebar">
				<div class="modal-body text-center">
                    <img style="width: 60px;height:60px;" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/python_logo.svg">
					<p style="font-family: Inter, sans-serif !important">Join 50,000+ Python Programmers &amp; Enthusiasts like you!</p>
					<div class="form-group">
                        <input type="hidden" name="csrfmiddlewaretoken" value="xM1B5AIqQVdA4PRnHZbBUH6QwT0iL8MEFqvfUfU2b1qwZU35BrIAYoPeUn5i5SQS">
                        
    
    
      
      <input type="email" name="email" class="form-control" placeholder="Enter your email" style="font-family: Inter, sans-serif !important;" required="" id="id_email">
      
      
        
      
    
  
                        <input type="hidden" name="form" value="1">
                        <input type="hidden" name="next" value="/article/real-time-vehicle-tracking-and-counting-with-yolov8-opencv">
                        <br>
                        <div><div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; display: block; transition: right 0.3s; position: fixed; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;"><div class="grecaptcha-logo"><iframe title="reCAPTCHA" width="256" height="60" role="presentation" name="a-3u5ac0xza3mv" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/anchor(1).html"></iframe></div><div class="grecaptcha-error"></div><textarea id="g-recaptcha-response-1" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div></div><button class="btn btn-primary g-recaptcha" id="sidebar-button" style="font-family: Inter, sans-serif !important;" data-sitekey="6LdFTfgoAAAAAPs7nop43W6L6XwiMhoIDeAVquUs" data-callback="onSubmitSidebar" data-action="submit" type="submit">Subscribe</button>
					</div>
				</div>
			</form>			
		</div>
	</div>
    <br>
    <h5 class="text-info">Tags</h5>
    <div class="list-group">
        <ul class="nav">
            
            
            <a class="list-group-item" style="color: black; font-size: 9.5pt; text-decoration: none;" href="https://thepythoncode.com/topic/ethical-hacking"><li>Ethical Hacking</li></a>
            
            
            
            <a class="list-group-item" style="background-color: #3b93e6; color: black; font-size: 9.5pt; text-decoration: none;" href="https://thepythoncode.com/topic/machine-learning"><li>Machine Learning</li></a>
            
            
            
            <a class="list-group-item" style="color: black; font-size: 9.5pt; text-decoration: none;" href="https://thepythoncode.com/topic/general-python-topics"><li>General Python Tutorials</li></a>
            
            
            
            <a class="list-group-item" style="color: black; font-size: 9.5pt; text-decoration: none;" href="https://thepythoncode.com/topic/web-scraping"><li>Web Scraping</li></a>
            
            
            
            <a class="list-group-item" style="color: black; font-size: 9.5pt; text-decoration: none;" href="https://thepythoncode.com/topic/finance"><li>Finance</li></a>
            
            
            
            <a class="list-group-item" style="background-color: #3b93e6; color: black; font-size: 9.5pt; text-decoration: none;" href="https://thepythoncode.com/topic/computer-vision"><li>Computer Vision</li></a>
            
            
            
            <a class="list-group-item" style="color: black; font-size: 9.5pt; text-decoration: none;" href="https://thepythoncode.com/topic/python-standard-library"><li>Python Standard Library</li></a>
            
            
            
            <a class="list-group-item" style="color: black; font-size: 9.5pt; text-decoration: none;" href="https://thepythoncode.com/topic/using-apis-in-python"><li>Application Programming Interfaces</li></a>
            
            
            
            <a class="list-group-item" style="color: black; font-size: 9.5pt; text-decoration: none;" href="https://thepythoncode.com/topic/using-databases-in-python"><li>Database</li></a>
            
            
            
            <a class="list-group-item" style="color: black; font-size: 9.5pt; text-decoration: none;" href="https://thepythoncode.com/topic/game-development"><li>Game Development</li></a>
            
            
            
            <a class="list-group-item" style="color: black; font-size: 9.5pt; text-decoration: none;" href="https://thepythoncode.com/topic/web-programming"><li>Web Programming</li></a>
            
            
            
            <a class="list-group-item" style="color: black; font-size: 9.5pt; text-decoration: none;" href="https://thepythoncode.com/topic/digital-forensics-with-python"><li>Digital Forensics</li></a>
            
            
            
            <a class="list-group-item" style="color: black; font-size: 9.5pt; text-decoration: none;" href="https://thepythoncode.com/topic/nlp"><li>Natural Language Processing</li></a>
            
            
            
            <a class="list-group-item" style="color: black; font-size: 9.5pt; text-decoration: none;" href="https://thepythoncode.com/topic/healthcare"><li>Healthcare</li></a>
            
            
            
            <a class="list-group-item" style="color: black; font-size: 9.5pt; text-decoration: none;" href="https://thepythoncode.com/topic/handling-pdf-files"><li>PDF File Handling</li></a>
            
            
            
            <a class="list-group-item" style="color: black; font-size: 9.5pt; text-decoration: none;" href="https://thepythoncode.com/topic/python-for-multimedia"><li>Python for Multimedia</li></a>
            
            
            
            <a class="list-group-item" style="color: black; font-size: 9.5pt; text-decoration: none;" href="https://thepythoncode.com/topic/gui-programming"><li>GUI Programming</li></a>
            
            
            
            <a class="list-group-item" style="color: black; font-size: 9.5pt; text-decoration: none;" href="https://thepythoncode.com/topic/cryptography-with-python"><li>Cryptography</li></a>
            
            
            
            <a class="list-group-item" style="color: black; font-size: 9.5pt; text-decoration: none;" href="https://thepythoncode.com/topic/scapy"><li>Packet Manipulation Using Scapy</li></a>
            
            
        </ul>
    </div>
    <br>
    
    
    
    
    
    
    <!-- Ezoic - sidebar_middle 134 - sidebar_middle -->
    
    <br>
    <h5><a href="https://thepythoncode.com/articles?o=date">New Tutorials</a></h5>
    <div class="list-group">
        <ul class="nav list-group-flush">
            
            <a class="list-group-item list-group-item-action" style="color: black;" href="https://thepythoncode.com/article/credit-card-validation-in-python"><li>How to Validate Credit Card Numbers in Python</li></a>
            
            <a class="list-group-item list-group-item-action" style="color: black;" href="https://thepythoncode.com/article/make-a-clickjacking-vulnerability-scanner-with-python"><li>How to Make a Clickjacking Vulnerability Scanner with Python</li></a>
            
            <a class="list-group-item list-group-item-action" style="color: black;" href="https://thepythoncode.com/article/reverse-dns-lookup-with-python"><li>How to Perform Reverse DNS Lookups Using Python</li></a>
            
            <a class="list-group-item list-group-item-action" style="color: black;" href="https://thepythoncode.com/article/test-password-strength-with-python"><li>How to Check Password Strength with Python</li></a>
            
            <a class="list-group-item list-group-item-action" style="color: black;" href="https://thepythoncode.com/article/breakout-game-pygame-in-python"><li>How to Build a Breakout Game with PyGame in Python</li></a>
            
        </ul>
    </div>
    <br>
    <h5><a href="https://thepythoncode.com/articles?o=views">Popular Tutorials</a></h5>
    <div class="list-group">
        <ul class="nav list-group-flush">
            
            <a class="list-group-item list-group-item-action" style="color: black;" href="https://thepythoncode.com/article/using-speech-recognition-to-convert-speech-to-text-python"><li>How to Convert Speech to Text in Python</li></a>
            
            <a class="list-group-item list-group-item-action" style="color: black;" href="https://thepythoncode.com/article/reading-emails-in-python"><li>How to Read Emails in Python</li></a>
            
            <a class="list-group-item list-group-item-action" style="color: black;" href="https://thepythoncode.com/article/extract-pdf-tables-in-python-camelot"><li>How to Extract Tables from PDF in Python</li></a>
            
            <a class="list-group-item list-group-item-action" style="color: black;" href="https://thepythoncode.com/article/write-a-keylogger-python"><li>How to Make a Keylogger in Python</li></a>
            
            <a class="list-group-item list-group-item-action" style="color: black;" href="https://thepythoncode.com/article/encrypt-decrypt-files-symmetric-python"><li>How to Encrypt and Decrypt Files in Python</li></a>
            
        </ul>
    </div>
    <br>
    <div class="sticky-top">
        <br id="before-jobs">
        
        
        
        
        <a href="https://www.thepythoncode.com/build-an-automatic-number-plate-recognition-system-with-opencv-and-yolo-ebook?utm_source=topic-article&amp;utm_medium=banner&amp;utm_campaign=square-bottom" target="_blank" rel="noopener">
            <img src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/mastering-yolo-banner.jpg" alt="Mastering YOLO - Topic - Bottom" data-xblocker="passed" style="visibility: visible;">
        </a>
        <br>
        <br>
        
        
        
        <br>
        <br>
        <br>
    <span id="ezoic-pub-ad-placeholder-117" class="ezoic-adpicker-ad"></span><span data-ez-ph-id="117"></span></div>
</div>
        </div>
    </div>
    
<br><br> 
<footer class="mt-5" style="background-color: #16161A;"> 
    <div class="container">
        <div class="row justify-content-between position-relative">
            <div class="col-12 col-lg-6 mb-3 pb-3 position-absolute top-0 end-0 translate-middle-y">
                <form action="https://thepythoncode.com/subscribe" method="POST" id="form-footer" class="card p-4 d-flex flex-column gap-3 bg-dark rounded-2 d-block align-items-center align-items-lg-start text-center">
                    <input type="hidden" name="csrfmiddlewaretoken" value="xM1B5AIqQVdA4PRnHZbBUH6QwT0iL8MEFqvfUfU2b1qwZU35BrIAYoPeUn5i5SQS">
                    <h4 style="text-align: center;" class="mb-0 text-white fw-bold">Subscribe to our Newsletter</h4>
                    <p class="mb-0 mt-3 text-white text-center" style="font-size: 12.5pt;">Join 50,000+ Python Programmers &amp; Enthusiasts like you!</p>
                    <label for="id_email" class="visually-hidden">Email address</label>
                    <input id="id_email" name="email" type="email" class="form-control" placeholder="Enter your email" required="">
                    <input type="hidden" name="form" value="3">
                    <input type="hidden" name="next" value="/article/real-time-vehicle-tracking-and-counting-with-yolov8-opencv">
                    <div><div class="grecaptcha-badge" data-style="none" style="width: 256px; height: 60px; position: fixed; visibility: hidden;"><div class="grecaptcha-logo"><iframe title="reCAPTCHA" width="256" height="60" role="presentation" name="a-ld4ojfmx8al3" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/anchor(2).html"></iframe></div><div class="grecaptcha-error"></div><textarea id="g-recaptcha-response-2" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div></div><button class="btn btn-primary btn-primary-main mt-2 text-center g-recaptcha" id="footer-button" data-sitekey="6LdFTfgoAAAAAPs7nop43W6L6XwiMhoIDeAVquUs" data-callback="onSubmitFooter" data-action="submit" type="submit">Subscribe</button>                    
                    <small style="color: grey; font-size: 10px;">This site is protected by reCAPTCHA and the Google 
                        <a href="https://policies.google.com/privacy">Privacy Policy</a> and
                        <a href="https://policies.google.com/terms">Terms of Service</a> apply.
                    </small>
                </form>
            </div>
            <div class="col-12 mt-5 mb-3 mb-lg-5 pt-3">
                <a class="navbar-brand" href="https://thepythoncode.com/" style="font-family: Inter,&#39;Helvetica Neue&#39;,Helvetica,Arial,sans-serif;"><img style="width: 40px;height:40px;" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/python_logo.svg" alt="Python Code"><b>&nbsp;&nbsp;The Python Code</b></a>
            </div>
            <div class="col-12 col-sm-6 col-lg-3 mb-3 text-white text-center text-sm-start">
                <h5 class="text-info text-uppercase" style="font-family: &#39;Inter&#39;, sans-serif;font-size:18px;">EBooks</h5>
                
                
                
                
                <a href="https://thepythoncode.com/ethical-hacking-with-python-ebook">
                    <p style="margin-bottom: 7px;margin-top: 19px; font-family: &#39;Inter&#39;, sans-serif;font-size:15px;">Ethical Hacking with Python EBook</p>
                </a>
                
                
                
                
                
                <a href="https://thepythoncode.com/practical-python-pdf-processing-ebook">
                    <p style="margin-bottom: 7px;margin-top: 19px; font-family: &#39;Inter&#39;, sans-serif;font-size:15px;">Practical Python PDF Processing EBook</p>
                </a>
                
                
                
                <a href="https://thepythoncode.com/cryptography-with-python-ebook">
                    <p style="margin-bottom: 7px;margin-top: 19px; font-family: &#39;Inter&#39;, sans-serif;font-size:15px;">Cryptography with Python EBook</p>
                </a>
                
                
                
                <a href="https://thepythoncode.com/build-an-automatic-number-plate-recognition-system-with-opencv-and-yolo-ebook">
                    <p style="margin-bottom: 7px;margin-top: 19px; font-family: &#39;Inter&#39;, sans-serif;font-size:15px;">Mastering YOLO: Build an Automatic Number Plate Recognition System</p>
                </a>
                
                
            </div>  
            <div class="col-12 col-sm-6 col-lg-3 mb-3 text-white text-center text-sm-start">
                <h5 class="text-info text-uppercase" style="font-family: &#39;Inter&#39;, sans-serif;font-size:18px;">Tools</h5>
                <a href="https://codingfleet.com/code-generator/python/">
                    <p style="margin-bottom: 7px;margin-top: 19px; font-family: &#39;Inter&#39;, sans-serif; font-size: 15px;">Python Code Generator</p>
                </a>
                <a href="https://codingfleet.com/code-assistant/python/">
                    <p style="margin-bottom: 7px;margin-top: 19px; font-family: &#39;Inter&#39;, sans-serif; font-size: 15px;">Python Code Assistant</p>
                </a>
                <a href="https://codingfleet.com/code-explainer/python/">
                    <p style="margin-bottom: 7px;margin-top: 19px; font-family: &#39;Inter&#39;, sans-serif; font-size: 15px;">Python Code Explainer</p>
                </a>
                <a href="https://codingfleet.com/code-enhancer/python/">
                    <p style="margin-bottom: 7px;margin-top: 19px; font-family: &#39;Inter&#39;, sans-serif; font-size: 15px;">Python Code Enhancer</p>
                </a>
                <a href="https://codingfleet.com/comment-generator/python/">
                    <p style="margin-bottom: 7px;margin-top: 19px; font-family: &#39;Inter&#39;, sans-serif; font-size: 15px;">Python Comment Generator</p>
                </a>
                <a href="https://codingfleet.com/unit-test-generator/python/">
                    <p style="margin-bottom: 7px;margin-top: 19px; font-family: &#39;Inter&#39;, sans-serif; font-size: 15px;">Python Unit Test Generator</p>
                </a>
                <a href="https://codingfleet.com/code-converter/python/">
                    <p style="margin-bottom: 7px;margin-top: 19px; font-family: &#39;Inter&#39;, sans-serif; font-size: 15px;">Python Code Converter</p>
                </a>
                <a href="https://codingfleet.com/public-generations/">
                    <p style="margin-bottom: 7px;margin-top: 19px; font-family: &#39;Inter&#39;, sans-serif; font-size: 15px;">Useful Code Snippets</p>
                </a>
            </div>
            <div class="col-12 col-sm-6 col-lg-3 mb-3 text-white text-center text-sm-start">
                <h5 class="text-info text-uppercase" style="font-family: &#39;Inter&#39;, sans-serif;font-size:18px;">Navigation</h5>
                <a href="https://thepythoncode.com/">
                    <p style="margin-bottom: 7px;margin-top: 19px; font-family: &#39;Inter&#39;, sans-serif; font-size: 15px;">Home</p>
                </a>
                <a href="https://thepythoncode.com/articles?o=date">
                    <p style="margin-bottom: 7px;margin-top: 19px; font-family: &#39;Inter&#39;, sans-serif; font-size: 15px;">Tutorials</p>
                </a>
                <a href="https://thepythoncode.com/write-with-us">
                    <p style="margin-bottom: 7px;margin-top: 19px; font-family: &#39;Inter&#39;, sans-serif; font-size: 15px;">Write with Us</p>
                </a>
                <a href="https://thepythoncode.com/about">
                    <p style="margin-bottom: 7px;margin-top: 19px; font-family: &#39;Inter&#39;, sans-serif; font-size: 15px;">About Us</p>
                </a>
                <a href="https://thepythoncode.com/contact">
                    <p style="margin-bottom: 7px;margin-top: 19px; font-family: &#39;Inter&#39;, sans-serif; font-size: 15px;">Contact Us</p>
                </a>
            </div>

            <div class="col-12 col-sm-6 col-lg-3 mb-3 text-white text-center text-sm-start">
                <h5 class="text-info text-uppercase" style="font-family: &#39;Inter&#39;, sans-serif;font-size:18px;">Useful Links</h5>
                <a href="https://thepythoncode.com/privacy-policy">
                    <p style="margin-bottom: 7px;margin-top: 19px; font-family: &#39;Inter&#39;, sans-serif; font-size: 15px;">Privacy Policy</p>
                </a>
                <a href="https://www.thepythoncode.com/direct-sales.html">
                    <p style="margin-bottom: 7px;margin-top: 19px; font-family: &#39;Inter&#39;, sans-serif; font-size: 15px;">Advertise</p>
                </a>
                <a href="https://thepythoncode.com/resources">
                    <p style="margin-bottom: 7px;margin-top: 19px; font-family: &#39;Inter&#39;, sans-serif; font-size: 15px;">Learning Resources</p>
                </a>
                <br>
                <ul class="list-unstyled d-flex gap-3 justify-content-center justify-content-sm-start">
                    <li><a class="link-body-emphasis" href="https://twitter.com/ThePythonCode1"><i class="fa-brands fa-square-x-twitter fa-2xl" style="color: #ffffff;"></i></a></li>
                    <li><a class="link-body-emphasis" href="https://github.com/x4nth055"><i class="fa-brands fa-square-github fa-2xl" style="color: #ffffff;"></i></a></li>
                    <li><a class="link-body-emphasis" href="https://www.facebook.com/thepythoncode"><i class="fa-brands fa-square-facebook fa-2xl" style="color: #ffffff;"></i></a></li>
                </ul> 
            </div>
        </div>
        <div class="d-flex flex-column flex-sm-row justify-content-center text-white pt-4 border-top">
            <p class="copyright text-info" style="font-family: Inter, Helvetica, sans-serif;">© 2024 The Python Code. All rights reserved.</p>
        </div>
    </div>
</footer>
    <script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/clean-blog.min.js.download"></script><iframe name="__gppLocator" style="display: none;" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/saved_resource(7).html"></iframe>
    <script>
        function onSubmitFooter(token) {
          document.getElementById("form-footer").submit();
        }

        function onSubmitModal(token) {
            document.getElementById("form-modal").submit();
        }

        function onSubmitSidebar(token) {
            document.getElementById("form-sidebar").submit();
        }
    </script>
    
<script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/prism.js.download"></script>


<div id="myModal" class="modal fade" style="display: none;" aria-hidden="true">
	<div class="modal-dialog modal-newsletter">
		<div class="modal-content">
			<form action="https://thepythoncode.com/subscribe" method="POST" id="form-modal">
                <div class="modal-header justify-content-center">
                    <div class="col-2"></div>
                    <h4 class="col-9 modal-title">Claim your Free YOLO EBook</h4>
                    <button type="button" class="col-1 btn-close" data-dismiss="modal" aria-hidden="true"></button>
                </div>
                <div class="modal-body text-center">
                    <div class="container">
                        <div class="row">
                            <div class="row">
                                <div class="col-sm">
                                    <img style="width: 200px; height: 200px; visibility: visible;" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/yolov4-custom-object-detection.png" data-xblocker="passed">
                                </div>
                                <div class="col-sm">
                                    <span style="font-family: Inter, sans-serif !important; font-size: 11pt;">
                                        <strong>Download a Completely Free EBook about YOLO Object Detection</strong>
                                    </span>
                                    <br><br>
                                    <span style="font-family: Inter, sans-serif !important; font-size: 11pt;">Build a custom object detector with YOLO from scratch using OpenCV in Python following this free EBook!</span>
                                </div>
                            </div>
                        </div>
                        <br> 
                        <div class="form-group">
                            <input type="hidden" name="csrfmiddlewaretoken" value="xM1B5AIqQVdA4PRnHZbBUH6QwT0iL8MEFqvfUfU2b1qwZU35BrIAYoPeUn5i5SQS">
                            
    
    
      
      <input type="email" name="email" class="form-control" placeholder="Enter your email" style="font-family: Inter, sans-serif !important;" required="" id="id_email">
      
      
        
      
    
  
                            <input type="hidden" name="form" value="2">
                            <input type="hidden" name="mail_label" value="SAMPLE_YOLO_EBOOK">
                            <input type="hidden" name="next" value="/article/real-time-vehicle-tracking-and-counting-with-yolov8-opencv">
                            <br>
                            <div><div class="grecaptcha-badge" data-style="none" style="width: 256px; height: 60px; position: fixed; visibility: hidden;"><div class="grecaptcha-logo"><iframe title="reCAPTCHA" width="256" height="60" role="presentation" name="a-gdr24nkj5gvz" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/anchor(3).html"></iframe></div><div class="grecaptcha-error"></div><textarea id="g-recaptcha-response-3" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><iframe style="display: none;" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/saved_resource(8).html"></iframe></div><button class="btn btn-primary g-recaptcha" style="font-family: Inter, sans-serif !important;" id="modal-button" data-sitekey="6LdFTfgoAAAAAPs7nop43W6L6XwiMhoIDeAVquUs" data-callback="onSubmitModal" data-action="submit" type="submit">Send it to me!</button>
                        </div>
                    </div>
                </div>
            </form>
		</div>
	</div>
</div>


<script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/utils.js.download"></script>
<script>
    function share_facebook() {
        window.open("https://www.facebook.com/sharer/sharer.php?u=https://thepythoncode.com/article/real-time-vehicle-tracking-and-counting-with-yolov8-opencv", "Popup", "location,status,scrollbars,resizable,width=800, height=500");  
    }
    function share_twitter() {
        window.open("https://www.twitter.com/share?url=https://thepythoncode.com/article/real-time-vehicle-tracking-and-counting-with-yolov8-opencv", "Popup", "location,status,scrollbars,resizable,width=800, height=500");
    }
    function share(className, shareFunc, url) {
        document.querySelectorAll(className).forEach(function(element) {
            element.addEventListener('click', function() {
                shareFunc();
                fetch(url, {headers: {"X-Requested-With": "XMLHttpRequest"}})
            });
        });
    }
    share('.fb-share', share_facebook, '/count-fb-shares/339');
    share('.twitter-share', share_twitter, '/count-twitter-shares/339'); 
    fetch("/count-view/339", {headers: {"X-Requested-With": "XMLHttpRequest"}})
        .then(response => response.text()) 
        .then(data => {
            if(data != "0") {
                data = parseInt(data);
                document.querySelector("#n-views").innerHTML = "· <i class='fas fa-eye'></i> " + nFormatter(data, 1);
            }
        });
    
    var modal = new bootstrap.Modal(document.getElementById('myModal'), {
        keyboard: false
    });
    setTimeout(() => {
        modal.show();
    }, 12000);
    document.querySelector('[data-dismiss="modal"]').addEventListener('click', () => modal.hide());
    
    let stripTags = (text) => {
        let div = document.createElement("div");
        div.innerHTML = text;
        return div.textContent || div.innerText || "";
    }
    let fixTrailingSpaces = (text) => {
        let splited_text = text.split("<br>");
        let result_text_arr = [];
        for(let i = 0; i < splited_text.length; i++) {
            let t = splited_text[i];
            let text_copy = (' ' + t).slice(1);
            while(text_copy.startsWith(" ")) {
                t = t.replace(" ", "&nbsp;");
                text_copy = text_copy.slice(1);
            }
            result_text_arr = result_text_arr.concat([t]);
        }
        return result_text_arr.join("<br>");
    }
    let spawnBreaksAndLinks = (text) => {
        let regex = /(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/gi;
        let matches = text.match(regex);
        if(matches != null) {
            for(let i = 0; i < matches.length; i++) {
                let m = matches[i];
                text = text.replace(m, `<a rel="ugc" href="` + m + `">` + m + `</a>&nbsp;`);
            }
        }
        text = text.replace("\n", "<br>");
        text = text.replace(/(\r\n|\n|\r)/gm, "<br>");
        while(text.includes("<br><br><br>")) {
            text = text.replace("<br><br><br>", "<br><br>");
        }
        text = fixTrailingSpaces(text);
        return text
    }
    
    let reply = (comment_id, author_name) => {
        document.querySelector("#success").innerHTML = "";
        document.querySelector("#reply-to").value = comment_id;
        document.querySelector("#replies").innerHTML = `<div class='alert alert-primary alert-dismissible fade show' style='font-size: 11.7pt;' role='alert'><strong>Reply to @` + author_name + `</strong><button type="button" id="close-reply" class="btn-close" data-dismiss="alert" aria-label="Close"></button></div>`;
    }
    let bindReplyButton = () => {
        let replyButtons = document.querySelectorAll(".reply-button");
        if (replyButtons == null || replyButtons.length == 0) {
            return;
        }
        for(let i = 0; i < replyButtons.length; i++) {
            let replyButton = replyButtons[i];
            replyButton.addEventListener("click", (e) => {
                let comment_id = e.target.id;
                let author_name = e.target.dataset.commentAuthor;
                reply(comment_id, author_name);
                window.location.replace("https://thepythoncode.com/article/real-time-vehicle-tracking-and-counting-with-yolov8-opencv#replies");
                document.querySelector("#close-reply").addEventListener("click", () => {
                    document.querySelector("#reply-to").value = "";
                    // get the parent element of the button, the alert
                    const alertEl = document.querySelector("#replies").firstElementChild;
                    //add the class 'fade' and 'show' to the alert if it doesn't have it
                    if (!alertEl.classList.contains("fade")) alertEl.classList.add("fade");
                    if (!alertEl.classList.contains("show")) alertEl.classList.add("show");
                    //remove the class 'show' after some time
                    setTimeout(() => alertEl.classList.remove("show"), 200);
                })
            })
        }
    }
    let submitComment = (email, name, subscribe, reply_to, content) => {
        let token = 'xM1B5AIqQVdA4PRnHZbBUH6QwT0iL8MEFqvfUfU2b1qwZU35BrIAYoPeUn5i5SQS';
        fetch("/comment", {
            method: "POST",
            headers: {"X-CSRFToken": token, "X-Requested-With": "XMLHttpRequest", "Content-Type": "application/x-www-form-urlencoded"},
            body: `email=${encodeURIComponent(email)}&name=${encodeURIComponent(
                name
                )}&subscribe=${encodeURIComponent(subscribe)}&content=${encodeURIComponent(
                content
                )}&reply_to=${encodeURIComponent(reply_to)}&article_id=${encodeURIComponent(
                    "339"
                )}&g_recaptcha_response=${encodeURIComponent(grecaptcha.getResponse())}`
        }).then(response => response.text()).then(data => {
            if(data == "success") {
                queryComments();
                document.querySelector("#success").innerHTML = `<div class='alert alert-success fade show' style='font-size: 11.7pt;' role='alert'>Your comment is pending for approval by the webmaster, we will soon send you an email once it's approved.</div> `;
                document.querySelector("textarea#comment-content").value = "";
            } else if(data == "captcha invalid") {
                document.querySelector("#recaptcha-invalid").innerHTML = `<div class='alert alert-danger fade show' style='font-size: 11.7pt;' role='alert'>reCaptcha invalid, please verify again.</div> `;
            }
            grecaptcha.reset();
        });
    }
    let getCommentHTML = (comment_id, author_image, author_name, date_published, content, reply_to_id=false, is_approved=true) => {
        let relativeDate = timeDifference(new Date(), date_published);
        let html = "";
        if(reply_to_id != false) {
            html += "<br>";
        }
        html += `<li id="comment-` + comment_id + `" class="media border border-light"`;
        if(reply_to_id != false) {
            html += ` style="margin-left: 50px;"`;
        }
        html += `><img src='` + author_image + `' alt='' class='img-circle' style="width: 13vmin; height: 11vmin; object-fit: cover; margin-right: 10px">
            <div class='media-body'>
                <strong class='text-info' style='font-size: 12pt;'>` + stripTags(author_name) + `</strong>
                <span class='text-muted' style='font-size: 11pt;'><small class='text-muted'>` + relativeDate + `</small></span><br>
                <span style='font-size: 11.7pt;'>` + spawnBreaksAndLinks(stripTags(content)) + `</span>
            </div><button id="`;
        if(is_approved) {
            if(reply_to_id == false) {
                html += comment_id;
            } else {
                html += reply_to_id;
            }
            html += `" data-comment-author="` + stripTags(author_name) + `" class='btn btn-link reply-button'>Reply</button></li>`;
        } else {
            html += comment_id + `" class='btn btn-warning approve-comment pull-right' style='margin: 20px'>APPROVE</button>
            <button id="` + comment_id + `" class='btn btn-danger delete-comment pull-right' style='margin: 20px'>DELETE</button>`
        }
        if(reply_to_id == false) {
            html += `<br>`;
        }
        return html;
    }

    let authorProfilePictures = [{'ehash': '48d9b6e9ef83238d713897bc9d8cec953d9e7716ba8696bda6d5f3c30096ac3a', 'profile_pic': '/media/authors/yacine-rouizi_9hOaIUv.jpg'}];
    async function generateEmailHash(email) {
        const encoder = new TextEncoder();
        const data = encoder.encode(email.toLowerCase());
        const digest = await crypto.subtle.digest('SHA-256', data);
        const hashArray = Array.from(new Uint8Array(digest));
        return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    }

    async function getAuthorProfilePicture(email) {
        // const emailHash = await generateEmailHash(email);
        // const author = authorProfilePictures.find(author => author.ehash === emailHash);
        // return author ? author.profile_pic : "/media/authors/default.PNG";
        return "/media/authors/default.PNG";
    }
    let queryComments = async () => {
        fetch("/comments/339", {headers: {"X-Requested-With": "XMLHttpRequest"}}) 
        .then((response) => { return response.json(); })
        .then(async (data) => {
            let comments = data[0];
            let replies = data[1];
            var is_superuser = "False" == "True";
            // check if there are any comments
            if(comments.length == 0 || comments == null) {
                return;
            }
            let updatedCommentContainer = document.createElement("div");
            // id, date_published, author_name, content, reply_to_id
            updatedCommentContainer.classList.add("media-list");
            for (const comment of comments) {
                var date_published = new Date(comment["date_published"]);
                var author_image = "/media/authors/default.PNG";
                if(comment["is_approved"]) {
                    let comment_html = getCommentHTML(comment["id"], author_image, comment["author_name"], date_published, comment["content"]);
                    updatedCommentContainer.innerHTML += comment_html;
                } else if(! comment["is_approved"] && is_superuser) {
                    let comment_html = getCommentHTML(comment["id"], author_image, comment["author_name"], date_published, comment["content"], false, is_approved=false);
                    updatedCommentContainer.innerHTML += comment_html;
                } 
            }
            if(replies.length != 0 && replies != null) {
                for (const reply of replies) {
                    var date_published = new Date(reply["date_published"]);
                    var author_image = "/media/authors/default.PNG";
                    if(reply["is_approved"]) {
                        let comment_html = getCommentHTML(reply["id"], author_image, reply["author_name"], date_published, reply["content"], reply["reply_to_id"]);
                        updatedCommentContainer.querySelector("li#comment-" + reply["reply_to_id"]).insertAdjacentHTML("afterend", comment_html);
                    } else if(! reply["is_approved"] && is_superuser) {
                        let comment_html = getCommentHTML(reply["id"], author_image, reply["author_name"], date_published, reply["content"], reply["reply_to_id"], is_approved=false);
                        updatedCommentContainer.querySelector("li#comment-" + reply["reply_to_id"]).insertAdjacentHTML("afterend", comment_html);
                    }
                };
            }
            const currentCommentContainer = document.querySelector(".media-list");
            currentCommentContainer.parentNode.replaceChild(updatedCommentContainer, currentCommentContainer);
            
            bindReplyButton();
            let media = document.querySelectorAll(".media");
            media.forEach((m) => {
                fadeOut(m);
                fadeIn(m);
            });
            media.forEach((m) => {
                fadeOut(m);
                fadeIn(m);
            });
        });
    }
    queryComments();
    document.querySelector("input#submit-comment").addEventListener("click", (e) => {
        document.querySelector("#success").innerHTML = "";
        let name = stripTags(document.querySelector("input#name").value).trim();
        let email = stripTags(document.querySelector("input#email").value).trim();
        let subscribe = document.querySelector("input#subscribe").checked;
        let reply_to = stripTags(document.querySelector("input#reply-to").value);
        let content = stripTags(document.querySelector("textarea#comment-content").value).trim();
        let email_regex = /^\b[A-Z0-9._%-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b$/i
        let name_valid  = name.length > 2;
        let email_valid = email_regex.test(email);
        let content_valid = content.split(" ").length >= 2;
        let nameValidEl = document.querySelector("#name-invalid");
        let emailValidEl = document.querySelector("#email-invalid");
        let contentValidEl = document.querySelector("#content-invalid");
        if(!name_valid) {
            nameValidEl.innerHTML = "<div class='alert alert-danger' style='font-size: 11.7pt;' role='alert'><li>Invalid Pseudo Name.</li></div>";
        } else {
            nameValidEl.innerHTML = "";
        }
        if(!email_valid) {
            emailValidEl.innerHTML = "<div class='alert alert-danger' style='font-size: 11.7pt;' role='alert'><li>Invalid Email address.</li></div>";
        } else {
            emailValidEl.innerHTML = "";
        }
        if(!content_valid) {
            contentValidEl.innerHTML = "<div class='alert alert-danger' style='font-size: 11.7pt;' role='alert'><li>Not enough words, only more than 2 words are acceptable.</li></div>";
            e.preventDefault();
            return false;
        } else {
            contentValidEl.innerHTML = "";
        }
        if(!email_valid || !name_valid || !content_valid) {
            e.preventDefault();
            return false;
        }
        document.querySelector("#replies").innerHTML = "";
        document.querySelector("#reply-to").value = "";
        contentValidEl.innerHTML = "";
        emailValidEl.innerHTML = "";
        nameValidEl.innerHTML = "";
        document.querySelector("#recaptcha-invalid").innerHTML = "";
        submitComment(email, name, subscribe, reply_to, content);
        e.preventDefault();
        return false;
    });
</script>

    


<!--[selectrongo:done]--><!--[selectrongo:video:done]--><span id="ezoic-pub-ad-placeholder-100"></span><span data-ez-ph-id="100"></span><script type="text/javascript" data-cfasync="false">!function(){var e=function(e,t){for(var r=0;r<t.length;r++){var n=t[r];if(0==n.complete||void 0!==n.readyState&&n.readyState<4){var o=n.getAttribute("src")||n.currentSrc;void 0!==n.readyState&&0==n.readyState?n.addEventListener("loadstart",(function(e){var t=e.currentTarget.getAttribute("src")||e.currentSrc;window.ezorqs(e,t)})):(o=n.getAttribute("src")||n.currentSrc,window.ezorqs(n,o)),n.addEventListener("load",(function(e){var t=e.currentTarget.getAttribute("src")||e.srcElement.currentSrc;window.ezorqe(e,t)})),n.addEventListener("loadeddata",(function(e){var t=e.currentTarget.getAttribute("src")||e.srcElement.currentSrc;window.ezorqe(e,t)})),n.addEventListener("error",(function(e){var t=e.currentTarget.getAttribute("src")||e.srcElement.currentSrc;window.ezorqe(e,t)}))}}};function t(e){for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].href==e)return!0;return!1}__ez_addAllListeners=function(){e(0,document.querySelectorAll("img")),e(0,document.querySelectorAll("video")),e(0,document.querySelectorAll("audio")),function(e){for(var r=0;r<e.length;r++){var n=e[r];if(("preload"==n.getAttribute("rel")||"stylesheet"==n.getAttribute("rel"))&&null!=n.getAttribute("href")&&t(n.getAttribute("href"))){window.ezorqs(n,n.getAttribute("href"));var o=document.createElement("img");o.onerror=function(e){void 0!==e.path&&void 0!==e.path[0].currentSrc?window.ezorqe(n,e.path[0].currentSrc):void 0!==e.srcElement&&void 0!==e.srcElement.href&&window.ezorqe(n,e.srcElement.href)},o.src=n.getAttribute("href")}}}(document.querySelectorAll("link")),void 0!==window.__ez.ssaf&&window.__ez.ssaf.indexOf(16)>-1&&void 0!==window.__ez.sshsdef&&!1===window.__ez.sshsdef&&Element.prototype.addEventListener&&("function"==typeof window.onload&&(window.addEventListener("load",window.onload),window.onload=null),"function"==typeof document.onload&&(document.addEventListener.addEventListener("load",document.onload),document.onload=null))},__ez.queue.addFunc("__ez_addAllListeners","__ez_addAllListeners",null,!1,["/detroitchicago/tulsa.js"],!0,!0,!0,!0)}();</script>
<script>var ezCcpaChangeLogId=645492;var ezCcpaCacheBusterId=10</script><script src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/ccpa.js.download" async=""></script><script data-cfasync="false">function _emitEzConsentEvent(){var customEvent=new CustomEvent("ezConsentEvent",{detail:{ezTcfConsent:window.ezTcfConsent},bubbles:true,cancelable:true,});document.dispatchEvent(customEvent);}
(function(window,document){function _setAllEzConsentTrue(){window.ezTcfConsent.loaded=true;window.ezTcfConsent.store_info=true;window.ezTcfConsent.develop_and_improve_services=true;window.ezTcfConsent.measure_ad_performance=true;window.ezTcfConsent.measure_content_performance=true;window.ezTcfConsent.select_basic_ads=true;window.ezTcfConsent.create_ad_profile=true;window.ezTcfConsent.select_personalized_ads=true;window.ezTcfConsent.create_content_profile=true;window.ezTcfConsent.select_personalized_content=true;window.ezTcfConsent.understand_audiences=true;window.ezTcfConsent.use_limited_data_to_select_content=true;window.ezTcfConsent.select_personalized_content=true;}
function _clearEzConsentCookie(){document.cookie="ezCMPCookieConsent=tcf2;Domain=.thepythoncode.com;Path=/;expires=Thu, 01 Jan 1970 00:00:00 GMT";}
_clearEzConsentCookie();if(typeof window.__tcfapi!=="undefined"){window.ezgconsent=false;var amazonHasRun=false;function _ezAllowed(tcdata,purpose){return(tcdata.purpose.consents[purpose]||tcdata.purpose.legitimateInterests[purpose]);}
function _reloadAds(){if(typeof window.ezorefgsl==="function"&&typeof window.ezslots==="object"){if(typeof __ezapsFetchBids=="function"&&amazonHasRun===false){ezapsFetchBids(__ezaps);if(typeof __ezapsVideo!="undefined"){ezapsFetchBids(__ezapsVideo,"video");}
amazonHasRun=true;}
var slots=[];for(var i=0;i<window.ezslots.length;i++){if(window[window.ezslots[i]]&&typeof window[window.ezslots[i]]==="object"){slots.push(window[window.ezslots[i]]);}else{setTimeout(_reloadAds,100);return false;}}
for(var i=0;i<slots.length;i++){window.ezorefgsl(slots[i]);}}else if(!window.ezadtimeoutset){window.ezadtimeoutset=true;setTimeout(_reloadAds,100);}}
function _handleConsentDecision(tcdata){window.ezTcfConsent.loaded=true;if(!tcdata.vendor.consents["347"]&&!tcdata.vendor.legitimateInterests["347"]){window._emitEzConsentEvent();return;}
window.ezTcfConsent.store_info=_ezAllowed(tcdata,"1");window.ezTcfConsent.develop_and_improve_services=_ezAllowed(tcdata,"10");window.ezTcfConsent.measure_content_performance=_ezAllowed(tcdata,"8");window.ezTcfConsent.select_basic_ads=_ezAllowed(tcdata,"2");window.ezTcfConsent.create_ad_profile=_ezAllowed(tcdata,"3");window.ezTcfConsent.select_personalized_ads=_ezAllowed(tcdata,"4");window.ezTcfConsent.create_content_profile=_ezAllowed(tcdata,"5");window.ezTcfConsent.measure_ad_performance=_ezAllowed(tcdata,"7");window.ezTcfConsent.use_limited_data_to_select_content=_ezAllowed(tcdata,"11");window.ezTcfConsent.select_personalized_content=_ezAllowed(tcdata,"6");window.ezTcfConsent.understand_audiences=_ezAllowed(tcdata,"9");window._emitEzConsentEvent();}
function _handleGoogleConsentV2(tcdata){if(!tcdata||!tcdata.purpose||!tcdata.purpose.consents){return;}
var googConsentV2={};if(tcdata.purpose.consents[1]){googConsentV2.ad_storage='granted';googConsentV2.analytics_storage='granted';}
if(tcdata.purpose.consents[3]&&tcdata.purpose.consents[4]){googConsentV2.ad_personalization='granted';}
if(tcdata.purpose.consents[1]&&tcdata.purpose.consents[7]){googConsentV2.ad_user_data='granted';}
if(googConsentV2.analytics_storage=='denied'){gtag('set','url_passthrough',true);}
gtag('consent','update',googConsentV2);}
__tcfapi("addEventListener",2,function(tcdata,success){if(!success||!tcdata){window._emitEzConsentEvent();return;}
if(!tcdata.gdprApplies){_setAllEzConsentTrue();window._emitEzConsentEvent();return;}
if(tcdata.eventStatus==="useractioncomplete"||tcdata.eventStatus==="tcloaded"){if(typeof gtag!='undefined'){_handleGoogleConsentV2(tcdata);}
_handleConsentDecision(tcdata);if(tcdata.purpose.consents["1"]===true&&tcdata.vendor.consents["755"]!==false){window.ezgconsent=true;(adsbygoogle=window.adsbygoogle||[]).pauseAdRequests=0;_reloadAds();}else{_reloadAds();}
if(window.__ezconsent){__ezconsent.setEzoicConsentSettings(ezConsentCategories);}
__tcfapi("removeEventListener",2,function(success){return null;},tcdata.listenerId);if(!(tcdata.purpose.consents["1"]===true&&_ezAllowed(tcdata,"2")&&_ezAllowed(tcdata,"3")&&_ezAllowed(tcdata,"4"))){if(typeof __ez=="object"&&typeof __ez.bit=="object"&&typeof window["_ezaq"]=="object"&&typeof window["_ezaq"]["page_view_id"]=="string"){__ez.bit.AddAndFire(window["_ezaq"]["page_view_id"],[new __ezDotData("non_personalized_ads",true),]);}}}});}else{_setAllEzConsentTrue();window._emitEzConsentEvent();}})(window,document);</script><div id="ez-CCPA" class="CCPA-bottom-absolute container"><div data-nosnippet="true"><div class="row"><div class="twelve columns"><p style="margin:1rem!important">We and our partners share information on your use of this website to help improve your experience.</p></div></div><div class="row"><div class="six columns"><button class="button-primary">Do not sell my info</button></div><div class="six columns"><button class="button-primary">I Consent</button></div></div></div></div><div id="uglipop_overlay_wrapper" style="position:absolute;top:0;bottom:0;left:0;right:0;display:none"><div id="uglipop_overlay" style="position: fixed; inset: 0px; opacity: 0.3; width: 100%; height: 100%; background-color: black; display: none;"></div></div><div id="uglipop_content_fixed" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); opacity: 1; z-index: 10000000; display: none;"><div id="uglipop_popbox"></div></div><div style="background-color: rgb(255, 255, 255); border: 1px solid rgb(204, 204, 204); box-shadow: rgba(0, 0, 0, 0.2) 2px 2px 3px; position: absolute; transition: visibility linear 0.3s, opacity 0.3s linear; opacity: 0; visibility: hidden; z-index: 2000000000; left: 0px; top: -10000px;"><div style="width: 100%; height: 100%; position: fixed; top: 0px; left: 0px; z-index: 2000000000; background-color: rgb(255, 255, 255); opacity: 0.05;"></div><div class="g-recaptcha-bubble-arrow" style="border: 11px solid transparent; width: 0px; height: 0px; position: absolute; pointer-events: none; margin-top: -11px; z-index: 2000000000;"></div><div class="g-recaptcha-bubble-arrow" style="border: 10px solid transparent; width: 0px; height: 0px; position: absolute; pointer-events: none; margin-top: -10px; z-index: 2000000000;"></div><div style="z-index: 2000000000; position: relative;"><iframe title="recaptcha challenge expires in two minutes" name="c-acgdeegi5rdw" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="./Real-Time Vehicle Detection, Tracking and Counting in Python - The Python Code_files/bframe.html" style="width: 100%; height: 100%;"></iframe></div></div></body></html>